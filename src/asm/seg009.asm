; Generated by restunts-export.py (Ghidra)
.8086
.model medium

include seg009.inc

seg009 segment byte public use16 'STUNTSC'
    assume cs:seg009, es:nothing, ss:nothing, ds:dseg

; undefined __cdecl16far load_tracks_menu_shapes(void)
load_tracks_menu_shapes_asm_ proc far
    var_198    = word ptr  -408
    var_196    = word ptr  -406
    var_194    = word ptr  -404
    var_192    = byte ptr  -402
    var_190    = byte ptr  -400
    var_18E    = byte ptr  -398
    var_18D    = byte ptr  -397
    var_18C    = byte ptr  -396
    var_18A    = byte ptr  -394
    var_188    = byte ptr  -392
    var_186    = byte ptr  -390
    var_184    = byte ptr  -388
    var_182    = byte ptr  -386
    var_180    = byte ptr  -384
    var_17F    = byte ptr  -383
    var_17E    = byte ptr  -382
    var_17C    = dword ptr -380
    var_178    = byte ptr  -376
    var_176    = byte ptr  -374
    var_174    = byte ptr  -372
    var_172    = word ptr  -370
    var_170    = word ptr  -368
    var_16E    = word ptr  -366
    var_16C    = word ptr  -364
    var_16A    = word ptr  -362
    var_168    = word ptr  -360
    var_166    = word ptr  -358
    var_164    = word ptr  -356
    var_162    = byte ptr  -354
    var_DC     = word ptr  -220
    var_DA     = byte ptr  -218
    var_D8     = byte ptr  -216
    var_D6     = byte ptr  -214
    var_D4     = byte ptr  -212
    var_D2     = word ptr  -210
    var_D0     = word ptr  -208
    var_CC     = word ptr  -204
    var_CA     = word ptr  -202
    var_C8     = word ptr  -200
    var_C6     = byte ptr  -198
    var_C4     = byte ptr  -196
    var_C2     = byte ptr  -194
    var_C0     = byte ptr  -192
    var_BE     = byte ptr  -190
    var_3A     = word ptr  -58
    var_38     = word ptr  -56
    var_36     = byte ptr  -54
    var_34     = byte ptr  -52
    var_32     = byte ptr  -50
    var_30     = byte ptr  -48
    var_2E     = byte ptr  -46
    var_2C     = byte ptr  -44
    var_2A     = word ptr  -42
    var_28     = word ptr  -40
    var_26     = word ptr  -38
    var_24     = word ptr  -36
    var_22     = word ptr  -34
    var_20     = word ptr  -32
    var_1E     = byte ptr  -30
    var_1C     = byte ptr  -28
    var_1A     = byte ptr  -26
    var_18     = word ptr  -24
    var_16     = byte ptr  -22
    var_14     = byte ptr  -20
    var_12     = byte ptr  -18
    var_10     = dword ptr -16
    var_C      = byte ptr  -12
    var_A      = byte ptr  -10
    var_8      = byte ptr   -8
    var_6      = byte ptr   -6
    var_4      = word ptr   -4
    var_2      = word ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0x198
    push    di
    push    si
    mov     ax, offset aSdtedit
    push    ax
    call    far ptr file_load_shape2d_fatal_thunk
    add     sp, 0x2
    mov     word ptr [bp+var_2A], ax
    mov     word ptr [bp+var_28], dx
    mov     ax, offset tracksmenushapes1
    push    ax
    mov     ax, offset aFlatlakelak1lak2lak3lak4highg
    push    ax
    push    dx
    push    word ptr [bp+var_2A]
    call    far ptr locate_many_resources
    add     sp, 0x8
    mov     ax, offset tracksmenushapes2
    push    ax
    mov     ax, offset aCrs0crs1crs2crs3
    push    ax
    push    word ptr [bp+var_28]
    push    word ptr [bp+var_2A]
    call    far ptr locate_many_resources
    add     sp, 0x8
    mov     ax, offset tracksmenushapes3
    push    ax
    mov     ax, offset aUcr0ucr1ucr2ucr3
    push    ax
    push    word ptr [bp+var_28]
    push    word ptr [bp+var_2A]
    call    far ptr locate_many_resources
    add     sp, 0x8
    mov     ax, 0xf
    push    ax
    les     bx, [tracksmenushapes2]
    push    word ptr es:[bx+0x2]
    mov     ax, word ptr es:[bx]
    imul    word ptr [video_flag1_is1]
    push    ax
    call    far ptr sprite_make_wnd
    add     sp, 0x6
    mov     word ptr [bp+var_172], ax
    mov     word ptr [bp+var_170], dx
    mov     ax, 0xf
    push    ax
    les     bx, [(tracksmenushapes2+1*4)]
    push    word ptr es:[bx+0x2]
    mov     ax, word ptr es:[bx]
    imul    word ptr [video_flag1_is1]
    push    ax
    call    far ptr sprite_make_wnd
    add     sp, 0x6
    mov     word ptr [bp+var_16E], ax
    mov     word ptr [bp+var_16C], dx
    mov     ax, 0xf
    push    ax
    les     bx, [(tracksmenushapes2+2*4)]
    push    word ptr es:[bx+0x2]
    mov     ax, word ptr es:[bx]
    imul    word ptr [video_flag1_is1]
    push    ax
    call    far ptr sprite_make_wnd
    add     sp, 0x6
    mov     word ptr [bp+var_16A], ax
    mov     word ptr [bp+var_168], dx
    mov     ax, 0xf
    push    ax
    les     bx, [(tracksmenushapes2+3*4)]
    push    word ptr es:[bx+0x2]
    mov     ax, word ptr es:[bx]
    imul    word ptr [video_flag1_is1]
    push    ax
    call    far ptr sprite_make_wnd
    add     sp, 0x6
    mov     word ptr [bp+var_166], ax
    mov     word ptr [bp+var_164], dx
    mov     ax, offset aTedit_0
    push    ax
    call    far ptr file_load_resfile
    add     sp, 0x2
    mov     word ptr [bp+var_22], ax
    mov     word ptr [bp+var_20], dx
    mov     ax, 0xf
    push    ax
    mov     ax, 0xc8
    push    ax
    mov     ax, 0x140
    push    ax
    call    far ptr sprite_make_wnd
    add     sp, 0x6
    mov     word ptr [wndsprite], ax
    mov     word ptr [wndsprite+2], dx
    mov     ax, offset aPbox
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_shape_alt
    add     sp, 0x6
    mov     word ptr [pboxshape], ax
    mov     word ptr [pboxshape+2], dx
    mov     ax, offset aSnam
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_shape_alt
    add     sp, 0x6
    mov     word ptr [bp+var_26], ax
    mov     word ptr [bp+var_24], dx
    mov     ax, offset aMnam
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_shape_alt
    add     sp, 0x6
    mov     word ptr [bp+var_4], ax
    mov     word ptr [bp+var_2], dx
    mov     ax, offset aTnam
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_shape_alt
    add     sp, 0x6
    mov     word ptr [bp+var_D2], ax
    mov     word ptr [bp+var_D0], dx
    mov     byte ptr [bp+var_D4], 0x0
    sub     si, si
LAB_2a2b_018e:
    mov     byte ptr [bp+si+0xfe9e], 0xff
    mov     byte ptr [bp+si+0xff42], 0xff
    inc     si
    cmp     si, 0x84
    jl      LAB_2a2b_018e
    sub     si, si
LAB_2a2b_01a1:
    mov     ax, si
    shl     ax, 0x1
    shl     ax, 0x1
    mov     word ptr [bp+var_194], ax
    mov     ax, word ptr [bp+var_26]
    mov     dx, word ptr [bp+var_24]
    add     ax, word ptr [bp+var_194]
    mov     word ptr [bp+var_17C], ax
    mov     word ptr [bp+var_17C+2], dx
    les     bx, [bp+var_17C]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [g_res_id], al
    mov     al, byte ptr es:[bx+0x1]
    mov     byte ptr [(g_res_id+1)], al
    mov     al, byte ptr es:[bx+0x2]
    mov     byte ptr [(g_res_id+2)], al
    mov     al, byte ptr es:[bx+0x3]
    mov     byte ptr [(g_res_id+3)], al
    mov     ax, offset g_res_id
    push    ax
    push    word ptr [bp+var_28]
    push    word ptr [bp+var_2A]
    call    far ptr locate_shape_fatal
    add     sp, 0x6
    mov     bx, word ptr [bp+var_194]
    mov     word ptr [bx+tracksmenushape2dunk], ax
    mov     word ptr [bx+tracksmenushape2dunk+2], dx
    mov     ax, si
    shl     ax, 0x1
    shl     ax, 0x1
    mov     word ptr [bp+var_196], ax
    mov     ax, word ptr [bp+var_4]
    mov     dx, word ptr [bp+var_2]
    add     ax, word ptr [bp+var_196]
    mov     word ptr [bp+var_17C], ax
    mov     word ptr [bp+var_17C+2], dx
    les     bx, [bp+var_17C]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [g_res_id], al
    mov     al, byte ptr es:[bx+0x1]
    mov     byte ptr [(g_res_id+1)], al
    mov     al, byte ptr es:[bx+0x2]
    mov     byte ptr [(g_res_id+2)], al
    mov     al, byte ptr es:[bx+0x3]
    mov     byte ptr [(g_res_id+3)], al
    mov     ax, offset g_res_id
    push    ax
    push    word ptr [bp+var_28]
    push    word ptr [bp+var_2A]
    call    far ptr locate_shape_fatal
    add     sp, 0x6
    mov     bx, word ptr [bp+var_196]
    mov     word ptr [bx+tracksmenushape2dunk2], ax
    mov     word ptr [bx+tracksmenushape2dunk2+2], dx
    inc     si
    cmp     si, 0xba                           ; 186 - number of elem. icons?
    jge     LAB_2a2b_025d
    jmp     near ptr LAB_2a2b_01a1
LAB_2a2b_025d:
    mov     byte ptr [bp+var_DA], 0xff
    mov     byte ptr [bp+var_2C], 0xff
    mov     byte ptr [bp+var_32], 0x1
    mov     byte ptr [bp+var_184], 0x1
    mov     byte ptr [bp+var_A], 0x1
    mov     byte ptr [bp+var_36], 0xff
    mov     byte ptr [bp+var_188], 0x1
    mov     byte ptr [bp+var_C6], 0x1
    mov     byte ptr [bp+var_30], 0x1
    mov     word ptr [bp+var_38], 0x0
    mov     byte ptr [bp+var_34], 0x0
    mov     byte ptr [bp+var_190], 0x0
    mov     word ptr [bp+var_18], 0x0
    mov     byte ptr [bp+var_18D], 0x0
    mov     byte ptr [bp+var_8], 0x0
    mov     byte ptr [bp+var_18C], 0x0
    mov     byte ptr [bp+var_C2], 0x0
    mov     byte ptr [bp+var_12], 0x0
    mov     al, byte ptr [byte_45D90]
    mov     byte ptr [bp+var_18E], al
    mov     al, byte ptr [byte_45E16]
    mov     byte ptr [bp+var_180], al
    mov     byte ptr [bp+var_17F], 0x7
    call    far ptr sprite_copy_wnd_to_1_clear
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0x16
    push    ax
    mov     ax, 0x66
    push    ax
    mov     ax, 0x3
    push    ax
    mov     ax, 0xd9
    push    ax
    mov     ax, offset aBti
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
    push    word ptr [word_407F0]
    push    word ptr [word_407EE]
    push    word ptr [word_407EC]
    mov     ax, 0xbe
    push    ax
    mov     ax, 0xce
    push    ax
    sub     ax, ax
    push    ax
    mov     ax, 0x5
    push    ax
    call    far ptr draw_border
    add     sp, 0xe
    push    word ptr [word_407F0]
    push    word ptr [word_407EE]
    push    word ptr [word_407EC]
    mov     ax, 0x9e
    push    ax
    mov     ax, 0x66
    push    ax
    mov     ax, 0x20
    push    ax
    mov     ax, 0xd9
    push    ax
    call    far ptr draw_border
    add     sp, 0xe
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x5e
    push    ax
    mov     ax, 0x8c
    push    ax
    mov     ax, 0xdd
    push    ax
    mov     ax, offset aBsc
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x2e
    push    ax
    mov     ax, 0x9c
    push    ax
    mov     ax, 0xdd
    push    ax
    mov     ax, offset aBlo
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x2e
    push    ax
    mov     ax, 0xac
    push    ax
    mov     ax, 0xdd
    push    ax
    mov     ax, offset aBsa
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x2e
    push    ax
    mov     ax, 0x9c
    push    ax
    mov     ax, 0x10d
    push    ax
    mov     ax, offset aBcl_0
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
    sub     ax, ax
    push    ax
    push    word ptr [word_407F8]
    push    word ptr [word_407F6]
    push    word ptr [word_407F4]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x2e
    push    ax
    mov     ax, 0xac
    push    ax
    mov     ax, 0x10d
    push    ax
    mov     ax, offset aBex
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    call    far ptr draw_button
    add     sp, 0x14
LAB_2a2b_0470:
    cmp     byte ptr [bp+var_A], 0x0
    jnz     LAB_2a2b_047f
    mov     al, byte ptr [bp+var_2C]
    cmp     byte ptr [bp+var_C6], al
    jz      LAB_2a2b_04c5
LAB_2a2b_047f:
    mov     byte ptr [bp+var_14], 0x1
    mov     byte ptr [bp+var_6], 0x1
    mov     byte ptr [bp+var_C4], 0x0
    cmp     byte ptr [bp+var_C6], 0x0
    jz      LAB_2a2b_04c5
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, byte ptr [bx+trkObjectList.ss_multiTileFlag]
    cbw
    cmp     ax, 0x1
    jz      LAB_2a2b_04bc
    cmp     ax, 0x2
    jz      LAB_2a2b_0510
    cmp     ax, 0x3
    jz      LAB_2a2b_051c
    jmp     LAB_2a2b_04c5
    db 0x90
LAB_2a2b_04bc:
    mov     byte ptr [bp+var_6], 0x2
    mov     byte ptr [bp+var_C4], 0x1
LAB_2a2b_04c5:
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_04ce
    jmp     near ptr LAB_2a2b_05a1
LAB_2a2b_04ce:
    cmp     byte ptr [bp+var_18E], 0x1d
    jnz     LAB_2a2b_04df
    cmp     byte ptr [bp+var_14], 0x2
    jnz     LAB_2a2b_04df
    dec     byte ptr [bp+var_18E]
LAB_2a2b_04df:
    cmp     byte ptr [bp+var_180], 0x1d
    jnz     LAB_2a2b_04f0
    cmp     byte ptr [bp+var_6], 0x2
    jnz     LAB_2a2b_04f0
    dec     byte ptr [bp+var_180]
LAB_2a2b_04f0:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_18E]
    cbw
    sub     ax, cx
    mov     cx, ax
    mov     al, byte ptr [bp+var_14]
    cbw
    add     cx, ax
    cmp     cx, 0xc
    jle     LAB_2a2b_052f
    inc     byte ptr [bp+var_8]
    jmp     LAB_2a2b_04f0
    db 0x90
LAB_2a2b_0510:
    mov     byte ptr [bp+var_C4], 0x2
    mov     byte ptr [bp+var_14], 0x2
    jmp     LAB_2a2b_04c5
    db 0x90
LAB_2a2b_051c:
    mov     byte ptr [bp+var_14], 0x2
    mov     byte ptr [bp+var_6], 0x2
    mov     byte ptr [bp+var_C4], 0x3
    jmp     LAB_2a2b_04c5
    db 0x90
LAB_2a2b_052c:
    dec     byte ptr [bp+var_8]
LAB_2a2b_052f:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_18E]
    cbw
    cmp     ax, cx
    jl      LAB_2a2b_052c
    jmp     LAB_2a2b_0544
LAB_2a2b_0540:
    inc     byte ptr [bp+var_18C]
LAB_2a2b_0544:
    mov     al, byte ptr [bp+var_18C]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_180]
    cbw
    sub     ax, cx
    mov     cx, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    add     cx, ax
    cmp     cx, 0xb
    jg      LAB_2a2b_0540
    jmp     LAB_2a2b_0566
    db 0x90
LAB_2a2b_0562:
    dec     byte ptr [bp+var_18C]
LAB_2a2b_0566:
    mov     al, byte ptr [bp+var_18C]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_180]
    cbw
    cmp     ax, cx
    jl      LAB_2a2b_0562
    mov     al, byte ptr [bp+var_17E]
    cmp     byte ptr [bp+var_8], al
    jnz     LAB_2a2b_0589
    mov     al, byte ptr [bp+var_D8]
    cmp     byte ptr [bp+var_18C], al
    jz      LAB_2a2b_05a1
LAB_2a2b_0589:
    mov     al, byte ptr [bp+var_8]
    mov     byte ptr [bp+var_17E], al
    mov     al, byte ptr [bp+var_18C]
    mov     byte ptr [bp+var_D8], al
    mov     byte ptr [bp+var_32], 0x1
    mov     byte ptr [bp+var_184], 0x1
LAB_2a2b_05a1:
    mov     al, byte ptr [bp+var_C6]
    cmp     byte ptr [bp+var_2C], al
    jnz     LAB_2a2b_05ad
    jmp     near ptr LAB_2a2b_0644
LAB_2a2b_05ad:
    mov     byte ptr [bp+var_A], 0x1
    mov     byte ptr [bp+var_2C], al
    jmp     LAB_2a2b_05c8
LAB_2a2b_05b6:
    cmp     byte ptr [bp+var_196], 0xff
    jnz     LAB_2a2b_05c4
    dec     byte ptr [bp+var_18D]
    jmp     LAB_2a2b_05c8
    db 0x90
LAB_2a2b_05c4:
    dec     byte ptr [bp+var_17F]
LAB_2a2b_05c8:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_196], al
    cmp     al, 0xfe
    jnc     LAB_2a2b_05b6
    call    far ptr sprite_copy_wnd_to_1
    mov     al, byte ptr [bp+var_C6]
    cbw
    push    ax
    push    cs
    call    near ptr preRender_icons
    add     sp, 0x2
    cmp     byte ptr [bp+var_C6], 0x0
    jnz     LAB_2a2b_061a
    mov     ax, 0x1
    push    ax
    push    ax
    sub     ax, ax
    jmp     LAB_2a2b_0628
    db 0x90
LAB_2a2b_061a:
    mov     ax, 0xa
    push    ax
    mov     ax, 0x1
    push    ax
    mov     al, byte ptr [bp+var_C6]
    cbw
    dec     ax
LAB_2a2b_0628:
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0x85
    push    ax
    mov     ax, 0x5f
    push    ax
    mov     ax, 0xdd
    push    ax
    sub     ax, ax
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
LAB_2a2b_0644:
    cmp     byte ptr [bp+var_30], 0x0
    jz      LAB_2a2b_0655
    mov     byte ptr [bp+var_30], 0x0
    push    cs
    call    near ptr sub_2C81C
    mov     byte ptr [bp+var_12], al
LAB_2a2b_0655:
    cmp     byte ptr [bp+var_32], 0x0
    jnz     LAB_2a2b_0664
    cmp     byte ptr [bp+var_A], 0x0
    jnz     LAB_2a2b_0664
    jmp     near ptr LAB_2a2b_085e
LAB_2a2b_0664:
    call    far ptr sprite_copy_wnd_to_1
    cmp     byte ptr [bp+var_32], 0x0
    jnz     LAB_2a2b_0672
    jmp     near ptr LAB_2a2b_071d
LAB_2a2b_0672:
    mov     byte ptr [bp+var_32], 0x0
    cmp     byte ptr [bp+var_184], 0x0
    jz      LAB_2a2b_06d3
    mov     byte ptr [bp+var_184], 0x0
    mov     ax, 0x1e
    push    ax
    mov     ax, 0xc
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0xb5
    push    ax
    mov     ax, 0xc0
    push    ax
    mov     ax, 0x9
    push    ax
    sub     ax, ax
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
    mov     ax, 0x1e
    push    ax
    mov     ax, 0xb
    push    ax
    mov     al, byte ptr [bp+var_18C]
    cbw
    push    ax
    mov     ax, 0xb0
    push    ax
    mov     ax, 0x4
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0xca
    push    ax
    sub     ax, ax
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
LAB_2a2b_06d3:
    mov     ax, 0xb3
    push    ax
    mov     ax, 0x4
    push    ax
    mov     ax, 0xc8
    push    ax
    mov     ax, 0x8
    push    ax
    call    far ptr sprite_set_1_size
    add     sp, 0x8
    lea     ax, [bp+var_BE]
    push    ax
    lea     ax, [bp+var_162]
    push    ax
    mov     al, byte ptr [bp+var_18C]
    cbw
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    push    ax
    push    cs
    call    near ptr draw_2DtrackMap
    add     sp, 0x8
    mov     ax, 0xc8
    push    ax
    sub     ax, ax
    push    ax
    mov     ax, 0x140
    push    ax
    sub     ax, ax
    push    ax
    call    far ptr sprite_set_1_size
    add     sp, 0x8
LAB_2a2b_071d:
    cmp     byte ptr [bp+var_A], 0x0
    jnz     LAB_2a2b_0726
    jmp     near ptr LAB_2a2b_0840
LAB_2a2b_0726:
    mov     byte ptr [bp+var_A], 0x0
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    add     bx, bp
    push    word ptr [bx+0xfe90]
    push    word ptr [bx+0xfe8e]
    call    far ptr sprite_set_1_from_argptr
    add     sp, 0x4
    cmp     byte ptr [bp+var_C6], 0x0
    jz      LAB_2a2b_0751
    jmp     near ptr LAB_2a2b_07de
LAB_2a2b_0751:
    sub     ax, ax
    push    ax
    push    ax
    mov     bl, byte ptr [bp+var_190]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    push    word ptr [performGraphColor]
    sub     ax, ax
    push    ax
    mov     ax, 0xf
    push    ax
    sub     ax, ax
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr preRender_line
    add     sp, 0xa
    push    word ptr [performGraphColor]
    mov     ax, 0xe
    push    ax
    mov     ax, 0xf
    push    ax
    mov     ax, 0xe
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr preRender_line
    add     sp, 0xa
    push    word ptr [performGraphColor]
    mov     ax, 0xe
    push    ax
    mov     ax, 0x1
    push    ax
    sub     ax, ax
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr preRender_line
    add     sp, 0xa
    push    word ptr [performGraphColor]
    mov     ax, 0xe
    push    ax
    mov     ax, 0xf
    push    ax
    sub     ax, ax
    push    ax
    mov     ax, 0xf
    push    ax
    call    far ptr preRender_line
    add     sp, 0xa
    jmp     LAB_2a2b_0840
    db 0x90
LAB_2a2b_07de:
    sub     ax, ax
    push    ax
    push    ax
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes2+2]
    push    word ptr [bx+tracksmenushapes2]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    cmp     byte ptr [bp+var_190], 0x0
    jz      LAB_2a2b_0840
    sub     ax, ax
    push    ax
    push    ax
    mov     bl, byte ptr [bp+var_190]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr putpixel_iconMask
    add     sp, 0x8
    sub     ax, ax
    push    ax
    push    ax
    mov     bl, byte ptr [bp+var_190]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk+2]
    push    word ptr [bx+tracksmenushape2dunk]
    call    far ptr putpixel_iconFillings
    add     sp, 0x8
LAB_2a2b_0840:
    mov     al, byte ptr [bp+var_36]
    cbw
    push    ax
    push    word ptr [wndsprite+2]
    push    word ptr [wndsprite]
    call    far ptr sprite_blit_to_video
    add     sp, 0x6
    mov     byte ptr [bp+var_36], 0xfe
    mov     byte ptr [bp+var_C2], 0xff
LAB_2a2b_085e:
    call    far ptr sprite_copy_2_to_1_2
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_086c
    jmp     near ptr LAB_2a2b_093a
LAB_2a2b_086c:
    mov     al, byte ptr [bp+var_14]
    mov     cl, 0x4
    shl     al, cl
    mov     byte ptr [bp+var_2E], al
    mov     al, byte ptr [bp+var_6]
    shl     al, cl
    mov     byte ptr [bp+var_1A], al
    mov     al, byte ptr [bp+var_18E]
    cbw
    mov     word ptr [bp+var_196], ax
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     dx, word ptr [bp+var_196]
    sub     dx, ax
    shl     dx, cl
    add     dx, 0x8
    mov     word ptr [bp+var_CA], dx
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     word ptr [bp+var_194], ax
    mov     al, byte ptr [bp+var_18C]
    cbw
    mov     dx, word ptr [bp+var_194]
    sub     dx, ax
    shl     dx, cl
    add     dx, 0x4
    mov     word ptr [bp+var_DC], dx
    mov     bx, word ptr [bp+var_194]
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    add     bx, word ptr [bp+var_196]
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_182], al
    sub     ah, ah
; Filler tests, etc.  
    cmp     ax, 0xfd
    jz      LAB_2a2b_08e8
    cmp     ax, 0xfe
    jz      LAB_2a2b_090c
    cmp     ax, 0xff
    jz      LAB_2a2b_092a
    jmp     near ptr LAB_2a2b_0a7b
LAB_2a2b_08e8:
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
LAB_2a2b_08f5:
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     al, byte ptr es:[bx-0x1]
LAB_2a2b_0904:
    mov     byte ptr [bp+var_182], al
    jmp     near ptr LAB_2a2b_0a7b
    db 0x90
LAB_2a2b_090c:
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     al, byte ptr es:[bx]
    jmp     LAB_2a2b_0904
    db 0x90
LAB_2a2b_092a:
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    jmp     LAB_2a2b_08f5
    db 0x90
LAB_2a2b_093a:
    mov     byte ptr [bp+var_2E], 0x10
    mov     byte ptr [bp+var_1A], 0x10
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    mov     word ptr [bp+var_DC], ax
    cmp     byte ptr [bp+var_17F], 0x6
    jnz     LAB_2a2b_096a
    mov     word ptr [bp+var_CA], 0xdc
    mov     byte ptr [bp+var_1A], 0x8
    mov     byte ptr [bp+var_2E], 0x60
    jmp     near ptr LAB_2a2b_0a6f
LAB_2a2b_096a:
    cmp     byte ptr [bp+var_17F], 0x7
    jnz     LAB_2a2b_0988
    sub     word ptr [bp+var_DC], 0x8
    mov     byte ptr [bp+var_18D], 0x0
    mov     word ptr [bp+var_CA], 0xdc
    mov     byte ptr [bp+var_2E], 0x60
    jmp     near ptr LAB_2a2b_0a6a
LAB_2a2b_0988:
    cmp     byte ptr [bp+var_17F], 0x7
    jle     LAB_2a2b_09be
    sub     word ptr [bp+var_DC], 0x8
    cmp     byte ptr [bp+var_18D], 0x3
    jge     LAB_2a2b_09a2
    mov     byte ptr [bp+var_18D], 0x0
    jmp     LAB_2a2b_09a7
LAB_2a2b_09a2:
    mov     byte ptr [bp+var_18D], 0x3
LAB_2a2b_09a7:
    mov     al, byte ptr [bp+var_18D]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0xdc
    mov     word ptr [bp+var_CA], ax
    mov     byte ptr [bp+var_2E], 0x30
    jmp     near ptr LAB_2a2b_0a6a
LAB_2a2b_09be:
    mov     al, byte ptr [bp+var_18D]
    cbw
    mov     word ptr [bp+var_196], ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0xdc
    mov     word ptr [bp+var_CA], ax
    cmp     byte ptr [bp+var_17F], 0x5
    jge     LAB_2a2b_0a05
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    add     bx, word ptr [bp+var_196]
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    cmp     byte ptr es:[bx+0x6], 0xfe
    jnz     LAB_2a2b_0a05
    mov     byte ptr [bp+var_1A], 0x20
LAB_2a2b_0a05:
    cmp     byte ptr [bp+var_18D], 0x5
    jge     LAB_2a2b_0a3b
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    cmp     byte ptr es:[bx+0x1], 0xff
    jnz     LAB_2a2b_0a3b
    mov     byte ptr [bp+var_2E], 0x20
LAB_2a2b_0a3b:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_182], al
    cmp     al, 0xfd
    jc      LAB_2a2b_0a6f
LAB_2a2b_0a6a:
    mov     byte ptr [bp+var_182], 0x0
LAB_2a2b_0a6f:
    cmp     byte ptr [bp+var_C6], 0x0
    jnz     LAB_2a2b_0a7b
    mov     byte ptr [bp+var_182], 0x0
LAB_2a2b_0a7b:
    mov     al, byte ptr [bp+var_C2]
    cmp     byte ptr [bp+var_182], al
    jnz     LAB_2a2b_0a88
    jmp     near ptr LAB_2a2b_0b44
LAB_2a2b_0a88:
    call    far ptr mouse_draw_opaque_check
    sub     ax, ax
    push    ax
    push    word ptr [dialog_fnt_colour]
    call    far ptr font_set_colour
    add     sp, 0x4
    mov     al, byte ptr [bp+var_182]
    sub     ah, ah
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx                             ; *3
    add     ax, word ptr [bp+var_D2]
    mov     dx, word ptr [bp+var_D0]
    mov     word ptr [bp+var_17C], ax
    mov     word ptr [bp+var_17C+2], dx
    les     bx, [bp+var_17C]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [g_res_id], al
    mov     al, byte ptr es:[bx+0x1]
    mov     byte ptr [(g_res_id+1)], al
    mov     al, byte ptr es:[bx+0x2]
    mov     byte ptr [(g_res_id+2)], al
    mov     ax, offset g_res_id
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, offset g_res_id
    push    ax
    call    far ptr copy_string
    add     sp, 0x6
    mov     ax, offset g_res_id
    push    ax
    call    far ptr font_op2
    add     sp, 0x2
    mov     si, ax
    mov     ax, 0xc0
    push    ax
    mov     ax, 0x8
    push    ax
    mov     ax, offset g_res_id
    push    ax
    call    far ptr sub_345BC
    add     sp, 0x6
    cmp     word ptr [bp+var_38], si
    jle     LAB_2a2b_0b34
    sub     ax, ax
    push    ax
    mov     ax, 0x8
    push    ax
    mov     ax, word ptr [bp+var_38]
    sub     ax, si
    push    ax
    mov     ax, 0xc0
    push    ax
    lea     ax, [si+0x8]
    push    ax
    call    far ptr sprite_1_fill_rect
    add     sp, 0xa
LAB_2a2b_0b34:
    call    far ptr mouse_draw_transparent_check
    mov     word ptr [bp+var_38], si
    mov     al, byte ptr [bp+var_182]
    mov     byte ptr [bp+var_C2], al
LAB_2a2b_0b44:
    cmp     byte ptr [bp+var_12], 0x0
    jz      LAB_2a2b_0b86
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     al, byte ptr [bp+var_12]
    cbw
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    add     ax, offset aEokenseieemseedewwefuenpestej
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     byte ptr [bp+var_12], 0x0
LAB_2a2b_0b86:
    mov     word ptr [bp+var_3A], 0x63
    mov     word ptr [bp+var_CC], 0x0
    call    far ptr mouse_draw_opaque_check
    mov     al, byte ptr [bp+var_34]
    mov     byte ptr [bp+var_16], al
    or      al, al
    jnz     LAB_2a2b_0bc3
    push    word ptr [bp+var_DC]
    push    word ptr [bp+var_CA]
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes3+2]
    push    word ptr [bx+tracksmenushapes3]
    call    far ptr sprite_clear_shape_alt
    add     sp, 0x8
LAB_2a2b_0bc3:
    cmp     word ptr [bp+var_3A], 0xf
    jg      LAB_2a2b_0bcc
    jmp     near ptr LAB_2a2b_0c5e
LAB_2a2b_0bcc:
    call    far ptr mouse_draw_opaque_check
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_0c26
    cmp     word ptr [bp+var_CC], 0x0
    jz      LAB_2a2b_0c04
    push    word ptr [bp+var_DC]
    push    word ptr [bp+var_CA]
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes3+2]
    push    word ptr [bx+tracksmenushapes3]
LAB_2a2b_0bf9:
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    jmp     LAB_2a2b_0c4f
    db 0x90
LAB_2a2b_0c04:
    push    word ptr [bp+var_DC]
    push    word ptr [bp+var_CA]
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    add     bx, bp
    les     bx, [bx+0xfe8e]
    push    word ptr es:[bx+0x2]
    push    word ptr es:[bx]
    jmp     LAB_2a2b_0bf9
LAB_2a2b_0c26:
    push    word ptr [word_407F2]
    mov     al, byte ptr [bp+var_1A]
    cbw
    add     ax, word ptr [bp+var_DC]
    dec     ax
    push    ax
    mov     al, byte ptr [bp+var_2E]
    cbw
    add     ax, word ptr [bp+var_CA]
    push    ax
    mov     ax, word ptr [bp+var_DC]
    dec     ax
    push    ax
    push    word ptr [bp+var_CA]
    call    far ptr sub_3702E
    add     sp, 0xa
LAB_2a2b_0c4f:
    call    far ptr mouse_draw_transparent_check
    xor     byte ptr [bp+var_CC], 0x1
    mov     word ptr [bp+var_3A], 0x0
LAB_2a2b_0c5e:
    call    far ptr timer_get_delta_alt
    mov     di, ax
    add     word ptr [bp+var_3A], di
    push    di
    call    far ptr input_checking
    add     sp, 0x2
    mov     word ptr [bp+var_C8], ax
    mov     ax, offset trackmenu2_buttons_y2
    push    ax
    mov     ax, offset trackmenu2_buttons_y1
    push    ax
    mov     ax, offset trackmenu2_buttons_x2
    push    ax
    mov     ax, offset trackmenu2_buttons_x1
    push    ax
    mov     ax, 0x5
    push    ax
    call    far ptr mouse_multi_hittest
    add     sp, 0xa
    mov     byte ptr [bp+var_18A], al
    cmp     al, 0xff
    jz      LAB_2a2b_0d18
    cbw
    or      ax, ax
    jz      LAB_2a2b_0cc0
    cmp     ax, 0x1
    jnz     LAB_2a2b_0ca6
    jmp     near ptr LAB_2a2b_0d88
LAB_2a2b_0ca6:
    cmp     ax, 0x2
    jnz     LAB_2a2b_0cae
    jmp     near ptr LAB_2a2b_0dd8
LAB_2a2b_0cae:
    cmp     ax, 0x3
    jnz     LAB_2a2b_0cb6
    jmp     near ptr LAB_2a2b_0e32
LAB_2a2b_0cb6:
    cmp     ax, 0x4
    jnz     LAB_2a2b_0cbe
    jmp     near ptr LAB_2a2b_0f00
LAB_2a2b_0cbe:
    jmp     LAB_2a2b_0d0c
LAB_2a2b_0cc0:
    test    byte ptr [mouse_butstate], 0x3
    jz      LAB_2a2b_0d0c
    mov     byte ptr [bp+var_34], 0x0
    mov     ax, 0x1e
    push    ax
    mov     ax, 0xc
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0xb5
    push    ax
    mov     ax, 0xc0
    push    ax
    mov     ax, 0x9
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
    mov     byte ptr [bp+var_186], al
    sub     al, byte ptr [bp+var_8]
    add     byte ptr [bp+var_18E], al
    mov     al, byte ptr [bp+var_186]
    mov     byte ptr [bp+var_8], al
LAB_2a2b_0d06:
    mov     word ptr [bp+var_C8], 0x1
LAB_2a2b_0d0c:
    cmp     word ptr [bp+var_C8], 0x1
    jnz     LAB_2a2b_0d18
    mov     byte ptr [bp+var_DA], 0xff
LAB_2a2b_0d18:
    cmp     word ptr [bp+var_C8], 0x0
    jnz     LAB_2a2b_0d2b
    cmp     word ptr [bp+var_18], 0x0
    jz      LAB_2a2b_0d2b
    mov     word ptr [bp+var_C8], 0x1
LAB_2a2b_0d2b:
    cmp     word ptr [bp+var_C8], 0x0
    jnz     LAB_2a2b_0d35
    jmp     near ptr LAB_2a2b_0bc3
LAB_2a2b_0d35:
    cmp     word ptr [bp+var_18], 0x0
    jz      LAB_2a2b_0d49
    mov     ax, 0xa
    cwd
    push    dx
    push    ax
    call    far ptr timer_get_counter_unk
    add     sp, 0x4
LAB_2a2b_0d49:
    cmp     word ptr [bp+var_CC], 0x0
    jnz     LAB_2a2b_0d53
    jmp     near ptr LAB_2a2b_1024
LAB_2a2b_0d53:
    call    far ptr mouse_draw_opaque_check
    cmp     byte ptr [bp+var_16], 0x0
    jz      LAB_2a2b_0d61
    jmp     near ptr LAB_2a2b_0ff6
LAB_2a2b_0d61:
    push    word ptr [bp+var_DC]
    push    word ptr [bp+var_CA]
    mov     al, byte ptr [bp+var_C4]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes3+2]
    push    word ptr [bx+tracksmenushapes3]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    jmp     near ptr LAB_2a2b_101f
    db 0x90
LAB_2a2b_0d88:
    test    byte ptr [mouse_butstate], 0x3
    jnz     LAB_2a2b_0d92
    jmp     near ptr LAB_2a2b_0d0c
LAB_2a2b_0d92:
    mov     byte ptr [bp+var_34], 0x0
    mov     ax, 0x1e
    push    ax
    mov     ax, 0xb
    push    ax
    mov     al, byte ptr [bp+var_18C]
    cbw
    push    ax
    mov     ax, 0xb0
    push    ax
    mov     ax, 0x4
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0xca
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
    mov     byte ptr [bp+var_186], al
    sub     al, byte ptr [bp+var_18C]
    add     byte ptr [bp+var_180], al
    mov     al, byte ptr [bp+var_186]
    mov     byte ptr [bp+var_18C], al
    jmp     near ptr LAB_2a2b_0d06
    db 0x90
LAB_2a2b_0dd8:
    cmp     byte ptr [bp+var_34], 0x1
    jnz     LAB_2a2b_0de5
    cmp     byte ptr [bp+var_17F], 0x6
    jz      LAB_2a2b_0df4
LAB_2a2b_0de5:
    mov     byte ptr [bp+var_34], 0x1
    mov     byte ptr [bp+var_17F], 0x6
    mov     word ptr [bp+var_C8], 0x1
LAB_2a2b_0df4:
    test    byte ptr [mouse_butstate], 0x3
    jnz     LAB_2a2b_0dfe
    jmp     near ptr LAB_2a2b_0d0c
LAB_2a2b_0dfe:
    mov     ax, 0xa
    push    ax
    mov     ax, 0x1
    push    ax
    mov     al, byte ptr [bp+var_C6]
    cbw
    dec     ax
    push    ax
    mov     ax, 0x5
    push    ax
    mov     ax, 0x85
    push    ax
    mov     ax, 0x5f
    push    ax
    mov     ax, 0xdd
    push    ax
    mov     ax, 0x1
    push    ax
    call    far ptr mouse_track_op
    add     sp, 0x10
    inc     al
    mov     byte ptr [bp+var_C6], al
    jmp     near ptr LAB_2a2b_0d06
LAB_2a2b_0e32:
    mov     ax, word ptr [mouse_xpos]
    sub     ax, 0x8
    cwd
    xor     ax, dx
    sub     ax, dx
    mov     cx, 0x4
    sar     ax, cl
    xor     ax, dx
    sub     ax, dx
    mov     byte ptr [bp+var_D6], al
    mov     ax, word ptr [mouse_ypos]
    sub     ax, cx
    cwd
    xor     ax, dx
    sub     ax, dx
    sar     ax, cl
    xor     ax, dx
    sub     ax, dx
    mov     byte ptr [bp+var_174], al
    cmp     byte ptr [bp+var_C6], 0x0
    jz      LAB_2a2b_0eaa
    cmp     al, 0xa
    jnz     LAB_2a2b_0e86
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x1
    jz      LAB_2a2b_0e86
    dec     byte ptr [bp+var_174]
LAB_2a2b_0e86:
    cmp     byte ptr [bp+var_D6], 0xb
    jnz     LAB_2a2b_0eaa
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x2
    jz      LAB_2a2b_0eaa
    dec     byte ptr [bp+var_D6]
LAB_2a2b_0eaa:
    mov     al, byte ptr [bp+var_8]
    add     byte ptr [bp+var_D6], al
    mov     al, byte ptr [bp+var_18C]
    add     byte ptr [bp+var_174], al
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_0ed3
    mov     al, byte ptr [bp+var_D6]
    cmp     byte ptr [bp+var_18E], al
    jnz     LAB_2a2b_0ed3
    mov     al, byte ptr [bp+var_174]
    cmp     byte ptr [bp+var_180], al
    jz      LAB_2a2b_0eed
LAB_2a2b_0ed3:
    mov     byte ptr [bp+var_34], 0x0
    mov     al, byte ptr [bp+var_D6]
    mov     byte ptr [bp+var_18E], al
    mov     al, byte ptr [bp+var_174]
    mov     byte ptr [bp+var_180], al
LAB_2a2b_0ee7:
    mov     word ptr [bp+var_C8], 0x1
LAB_2a2b_0eed:
    cmp     word ptr [bp+var_C8], 0x20
    jz      LAB_2a2b_0ef7
    jmp     near ptr LAB_2a2b_0d0c
LAB_2a2b_0ef7:
    mov     word ptr [bp+var_C8], 0xd
    jmp     near ptr LAB_2a2b_0d0c
LAB_2a2b_0f00:
    mov     ax, word ptr [mouse_xpos]
    sub     ax, 0xdc
    cwd
    xor     ax, dx
    sub     ax, dx
    mov     cx, 0x4
    sar     ax, cl
    xor     ax, dx
    sub     ax, dx
    mov     byte ptr [bp+var_D6], al
    mov     ax, word ptr [mouse_ypos]
    sub     ax, 0x24
    cwd
    xor     ax, dx
    sub     ax, dx
    sar     ax, cl
    xor     ax, dx
    sub     ax, dx
    mov     byte ptr [bp+var_174], al
    cmp     al, 0x6
    jl      LAB_2a2b_0f34
    jmp     near ptr LAB_2a2b_0fc4
LAB_2a2b_0f34:
    cbw
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    shl     ax, 0x1
    mov     cx, ax
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    mov     bx, ax
    add     bx, cx
    mov     al, byte ptr [bp+var_D6]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    cmp     byte ptr es:[bx], 0xfe
    jnz     LAB_2a2b_0f62
    dec     byte ptr [bp+var_174]
LAB_2a2b_0f62:
    mov     al, byte ptr [bp+var_174]
    cbw
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    shl     ax, 0x1
    mov     cx, ax
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    mov     bx, ax
    add     bx, cx
    mov     al, byte ptr [bp+var_D6]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    cmp     byte ptr es:[bx], 0xff
    jnz     LAB_2a2b_0f90
    dec     byte ptr [bp+var_D6]
LAB_2a2b_0f90:
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_0fad
    mov     al, byte ptr [bp+var_D6]
    cmp     byte ptr [bp+var_18D], al
    jnz     LAB_2a2b_0fad
    mov     al, byte ptr [bp+var_174]
    cmp     byte ptr [bp+var_17F], al
    jnz     LAB_2a2b_0fad
    jmp     near ptr LAB_2a2b_0eed
LAB_2a2b_0fad:
    mov     al, byte ptr [bp+var_D6]
    mov     byte ptr [bp+var_18D], al
    mov     al, byte ptr [bp+var_174]
    mov     byte ptr [bp+var_17F], al
    mov     byte ptr [bp+var_34], 0x1
    jmp     near ptr LAB_2a2b_0ee7
LAB_2a2b_0fc4:
    mov     ax, word ptr [mouse_ypos]
    sub     ax, 0x1c
    cwd
    xor     ax, dx
    sub     ax, dx
    mov     cx, 0x4
    sar     ax, cl
    xor     ax, dx
    sub     ax, dx
    mov     byte ptr [bp+var_174], al
    cmp     al, 0x7
    jnz     LAB_2a2b_0fe8
LAB_2a2b_0fe0:
    mov     byte ptr [bp+var_D6], 0x0
    jmp     LAB_2a2b_0f90
    db 0x90
LAB_2a2b_0fe8:
    cmp     byte ptr [bp+var_D6], 0x3
    jl      LAB_2a2b_0fe0
    mov     byte ptr [bp+var_D6], 0x3
    jmp     LAB_2a2b_0f90
LAB_2a2b_0ff6:
    push    word ptr [word_407F2]
    mov     al, byte ptr [bp+var_1A]
    cbw
    add     ax, word ptr [bp+var_DC]
    dec     ax
    push    ax
    mov     al, byte ptr [bp+var_2E]
    cbw
    add     ax, word ptr [bp+var_CA]
    push    ax
    mov     ax, word ptr [bp+var_DC]
    dec     ax
    push    ax
    push    word ptr [bp+var_CA]
    call    far ptr sub_3702E
    add     sp, 0xa
LAB_2a2b_101f:
    call    far ptr mouse_draw_transparent_check
LAB_2a2b_1024:
    cmp     word ptr [bp+var_18], 0x0
    jz      LAB_2a2b_10a6
    cmp     word ptr [bp+var_C8], 0x1
    jnz     LAB_2a2b_1037
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_103e
LAB_2a2b_1037:
    mov     ax, word ptr [track_pieces_counter]
    dec     ax
    mov     word ptr [bp+var_18], ax
LAB_2a2b_103e:
    mov     bx, word ptr [bp+var_18]
    add     bx, word ptr [td21_col_from_path]
    mov     es, word ptr [td21_col_from_path+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_18E], al
    mov     bx, word ptr [bp+var_18]
    add     bx, word ptr [td22_row_from_path]
    mov     es, word ptr [td22_row_from_path+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_180], al
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_190], al
    mov     byte ptr [bp+var_32], 0x1
    mov     byte ptr [bp+var_A], 0x1
    inc     word ptr [bp+var_18]
    mov     ax, word ptr [track_pieces_counter]
    cmp     word ptr [bp+var_18], ax
    jge     LAB_2a2b_1097
    jmp     near ptr LAB_2a2b_0470
LAB_2a2b_1097:
    mov     al, byte ptr [bp+var_1E]
    mov     byte ptr [bp+var_190], al
    mov     word ptr [bp+var_18], 0x0
    jmp     near ptr LAB_2a2b_0470
LAB_2a2b_10a6:
    mov     word ptr [bp+var_18], 0x0
    sub     si, si
    jmp     LAB_2a2b_10b1
    db 0x90
LAB_2a2b_10b0:
    inc     si
LAB_2a2b_10b1:
    cmp     si, 0xa
    jge     LAB_2a2b_10d2
    mov     bx, si
    shl     bx, 0x1
    mov     ax, word ptr [bp+var_C8]
    cmp     word ptr [bx+word_3ECBE], ax
    jnz     LAB_2a2b_10b0
    mov     ax, si
    inc     al
    mov     byte ptr [bp+var_C6], al
    mov     word ptr [bp+var_C8], 0x0
LAB_2a2b_10d2:
    mov     ax, word ptr [bp+var_C8]
    cmp     ax, 0x63
    jz      LAB_2a2b_113a
    jbe     LAB_2a2b_10e0
    jmp     near ptr LAB_2a2b_1b4e
LAB_2a2b_10e0:
    cmp     ax, 0xd
    jnz     LAB_2a2b_10e8
    jmp     near ptr LAB_2a2b_11ea
LAB_2a2b_10e8:
    cmp     ax, 0x20
    jz      LAB_2a2b_1100
    cmp     ax, 0x2b
    jz      LAB_2a2b_111a
    cmp     ax, 0x2d
    jz      LAB_2a2b_1108
    cmp     ax, 0x43
    jz      LAB_2a2b_113a
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_1100:
    xor     byte ptr [bp+var_34], 0x1
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_1108:
    cmp     byte ptr [bp+var_C6], 0x1
    jg      LAB_2a2b_1112
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1112:
    dec     byte ptr [bp+var_C6]
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_111a:
    cmp     byte ptr [bp+var_C6], 0xa
    jl      LAB_2a2b_1124
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1124:
    inc     byte ptr [bp+var_C6]
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_112c:
    mov     byte ptr [bp+var_C6], 0x0
    mov     byte ptr [bp+var_190], 0x0
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_113a:
    call    far ptr track_setup
    cbw
    mov     si, ax
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, si
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    add     ax, offset aEokenseieemseedewwefuenpestej
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    cmp     si, 0x1
    jle     LAB_2a2b_11e1
    mov     byte ptr [bp+var_34], 0x0
    cmp     word ptr [track_pieces_counter], 0x0
    jnz     LAB_2a2b_1198
    mov     al, byte ptr [byte_45D90]
    mov     byte ptr [bp+var_18E], al
    mov     al, byte ptr [byte_45E16]
    mov     byte ptr [bp+var_180], al
    jmp     LAB_2a2b_11e1
LAB_2a2b_1198:
    les     bx, [td21_col_from_path]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_18E], al
    les     bx, [td22_row_from_path]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_180], al
    mov     al, byte ptr [bp+var_190]
    mov     byte ptr [bp+var_1E], al
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_190], al
    mov     word ptr [bp+var_18], 0x1
    mov     byte ptr [bp+var_A], 0x1
LAB_2a2b_11e1:
    call    far ptr check_input
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_11ea:
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_11f3
    jmp     near ptr LAB_2a2b_163e
LAB_2a2b_11f3:
    cmp     byte ptr [bp+var_17F], 0x6
    jl      LAB_2a2b_11fd
    jmp     near ptr LAB_2a2b_1294
LAB_2a2b_11fd:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_190], al
    cmp     byte ptr [bp+var_C6], 0x0
    jz      LAB_2a2b_128a
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x1
    jz      LAB_2a2b_125b
    mov     al, byte ptr [bp+var_18C]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_180]
    cbw
    sub     ax, cx
    cmp     ax, 0xa
    jnz     LAB_2a2b_125b
    dec     byte ptr [bp+var_180]
LAB_2a2b_125b:
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x2
    jz      LAB_2a2b_128a
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     cx, ax
    mov     al, byte ptr [bp+var_18E]
    cbw
    sub     ax, cx
    cmp     ax, 0xb
    jnz     LAB_2a2b_128a
    dec     byte ptr [bp+var_18E]
LAB_2a2b_128a:
    inc     byte ptr [bp+var_A]
    mov     byte ptr [bp+var_34], 0x0
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1294:
    mov     byte ptr [bp+var_30], 0x1
    cmp     byte ptr [bp+var_17F], 0x6
    jnz     LAB_2a2b_12b6
    inc     byte ptr [bp+var_C6]
    cmp     byte ptr [bp+var_C6], 0xa
    jg      LAB_2a2b_12ad
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_12ad:
    mov     byte ptr [bp+var_C6], 0x1
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_12b6:
    cmp     byte ptr [bp+var_17F], 0x7
    jnz     LAB_2a2b_1316
    les     bx, [td14_elem_map_main]
    mov     al, byte ptr es:[bx+0x384]
    sub     ah, ah
    push    ax
    sub     ax, ax
    push    ax
    push    word ptr [dialogarg2]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aMss
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    mov     ax, 0x2
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     byte ptr [bp+var_C], al
    cmp     al, 0xff
    jnz     LAB_2a2b_1303
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1303:
    cmp     al, 0x5
    jnz     LAB_2a2b_130a
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_130a:
    les     bx, [td14_elem_map_main]
    mov     byte ptr es:[bx+0x384], al
    jmp     near ptr LAB_2a2b_13b8
LAB_2a2b_1316:
    cmp     byte ptr [bp+var_17F], 0x8
    jz      LAB_2a2b_1320
    jmp     near ptr LAB_2a2b_13c4
LAB_2a2b_1320:
    cmp     byte ptr [bp+var_18D], 0x0
    jnz     LAB_2a2b_132a
    jmp     near ptr LAB_2a2b_13c4
LAB_2a2b_132a:
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [dialogarg2]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aMen
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    mov     ax, 0x2
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     byte ptr [bp+var_C], al
    cmp     al, 0xff
    jnz     LAB_2a2b_1365
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1365:
    cmp     al, 0x5
    jnz     LAB_2a2b_136c
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_136c:
    sub     si, si
LAB_2a2b_136e:
    les     bx, [td14_elem_map_main]
    mov     byte ptr es:[bx+si], 0x0
    inc     si
    cmp     si, 0x384
    jl      LAB_2a2b_136e
    mov     al, byte ptr [bp+var_C]
    add     al, 0x30
    mov     byte ptr [(aTer0+3)], al
    mov     ax, offset aTer0
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_shape_alt
    add     sp, 0x6
    mov     word ptr [bp+var_10], ax
    mov     word ptr [bp+var_10+2], dx
    sub     si, si
LAB_2a2b_139f:
    les     bx, [bp+var_10]
    mov     al, byte ptr es:[bx+si]
    les     bx, [td15_terr_map_main]
    mov     byte ptr es:[bx+si], al
    inc     si
    cmp     si, 0x385
    jl      LAB_2a2b_139f
    mov     byte ptr [gameconfig.game_trackname], 0x0
LAB_2a2b_13b8:
    inc     byte ptr [bp+var_32]
    mov     byte ptr [bp+var_D4], 0x1
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_13c4:
    cmp     byte ptr [bp+var_17F], 0x8
    jz      LAB_2a2b_13ce
    jmp     near ptr LAB_2a2b_14ac
LAB_2a2b_13ce:
    cmp     byte ptr [bp+var_18D], 0x0
    jz      LAB_2a2b_13d8
    jmp     near ptr LAB_2a2b_14ac
LAB_2a2b_13d8:
    call    far ptr sprite_copy_2_to_1_2
    cmp     byte ptr [bp+var_D4], 0x0
    jz      LAB_2a2b_141e
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aChl
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    mov     ax, 0x2
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     si, ax
    or      si, si
    jnz     LAB_2a2b_141e
    jmp     near ptr LAB_2a2b_14b6
LAB_2a2b_141e:
    mov     si, 0x1
    mov     byte ptr [g_is_busy], 0x1
    inc     byte ptr [bp+var_32]
    mov     ax, offset aTrk_0
    push    ax
    push    word ptr [mainresptr+2]
    push    word ptr [mainresptr]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx                                 ; int
    push    ax                                 ; int
    mov     ax, offset a_trk_2
    push    ax                                 ; int
    mov     ax, offset gameconfig.game_trackname
    push    ax
    mov     ax, offset byte_3B80C
    push    ax                                 ; char *
    call    far ptr do_fileselect_dialog
    add     sp, 0xa
    cbw
    mov     si, ax
    mov     ax, offset g_path_buf
    push    ax                                 ; char *
    mov     ax, offset a_trk_3
    push    ax                                 ; int
    mov     ax, offset gameconfig.game_trackname
    push    ax
    mov     ax, offset byte_3B80C
    push    ax                                 ; char *
    call    far ptr file_build_path
    add     sp, 0x8
    or      si, si
    jg      LAB_2a2b_1475
    jmp     near ptr LAB_2a2b_15eb
LAB_2a2b_1475:
    push    word ptr [td14_elem_map_main+2]
    push    word ptr [td14_elem_map_main]
    mov     ax, offset g_path_buf
    push    ax
    call    far ptr file_read_fatal
    add     sp, 0x6
    call    far ptr track_setup
    mov     byte ptr [bp+var_34], 0x0
    mov     al, byte ptr [byte_45E16]
    mov     byte ptr [bp+var_180], al
    mov     al, byte ptr [byte_45D90]
    mov     byte ptr [bp+var_18E], al
    mov     byte ptr [bp+var_D4], 0x0
    inc     byte ptr [bp+var_32]
    jmp     near ptr LAB_2a2b_15eb
    db 0x90
LAB_2a2b_14ac:
    cmp     byte ptr [bp+var_18D], 0x0
    jz      LAB_2a2b_14b6
    jmp     near ptr LAB_2a2b_15f4
LAB_2a2b_14b6:
    mov     byte ptr [bp+var_176], 0x0
    mov     byte ptr [g_is_busy], 0x1
    jmp     near ptr LAB_2a2b_15e1
    db 0x90
LAB_2a2b_14c4:
    call    far ptr sprite_copy_2_to_1_2
    inc     byte ptr [bp+var_32]
    mov     ax, offset aTrk_1
    push    ax
    push    word ptr [mainresptr+2]
    push    word ptr [mainresptr]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx                                 ; int
    push    ax                                 ; int
    mov     ax, offset gameconfig.game_trackname
    push    ax
    mov     ax, offset byte_3B80C
    push    ax                                 ; char *
    call    far ptr do_savefile_dialog
    add     sp, 0x8
    or      al, al
    jz      LAB_2a2b_155d
    mov     ax, offset g_path_buf
    push    ax                                 ; char *
    mov     ax, offset a_trk_4
    push    ax                                 ; int
    mov     ax, offset gameconfig.game_trackname
    push    ax
    mov     ax, offset byte_3B80C
    push    ax                                 ; char *
    call    far ptr file_build_path
    add     sp, 0x8
    mov     byte ptr [bp+var_176], 0x1
    mov     ax, offset g_path_buf
    push    ax
    call    far ptr file_find
    add     sp, 0x2
    or      ax, ax
    jz      LAB_2a2b_1562
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aFex
    push    ax
    push    word ptr [mainresptr+2]
    push    word ptr [mainresptr]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    mov     ax, 0x2
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     si, ax
    cmp     si, -0x1
    jnz     LAB_2a2b_15d0
LAB_2a2b_155d:
    mov     byte ptr [bp+var_176], 0xff
LAB_2a2b_1562:
    cmp     byte ptr [bp+var_176], 0x1
    jnz     LAB_2a2b_15e1
    mov     ax, 0x70a                          ; .trk size
    cwd
    push    dx
    push    ax
    push    word ptr [td14_elem_map_main+2]
    push    word ptr [td14_elem_map_main]
    mov     ax, offset g_path_buf
    push    ax
    call    far ptr file_write_fatal
    add     sp, 0xa
    mov     si, ax
    or      si, si
    jnz     LAB_2a2b_1595
    mov     ax, 0x1
    push    ax
    call    far ptr highscore_write_a
    add     sp, 0x2
LAB_2a2b_1595:
    or      si, si
    jz      LAB_2a2b_15dc
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aSer
    push    ax
    push    word ptr [mainresptr+2]
    push    word ptr [mainresptr]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     byte ptr [bp+var_176], 0x0
    jmp     LAB_2a2b_15e1
LAB_2a2b_15d0:
    or      si, si
    jnz     LAB_2a2b_1562
    mov     byte ptr [bp+var_176], 0x0
    jmp     LAB_2a2b_1562
    db 0x90
LAB_2a2b_15dc:
    mov     byte ptr [bp+var_D4], 0x0
LAB_2a2b_15e1:
    cmp     byte ptr [bp+var_176], 0x0
    jnz     LAB_2a2b_15eb
    jmp     near ptr LAB_2a2b_14c4
LAB_2a2b_15eb:
    mov     byte ptr [g_is_busy], 0x0
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_15f4:
    cmp     byte ptr [bp+var_D4], 0x0
    jz      LAB_2a2b_1635
    sub     ax, ax
    push    ax
    push    ax
    push    word ptr [performGraphColor]
    mov     ax, 0xffff
    push    ax
    push    ax
    mov     ax, offset aChx
    push    ax
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr locate_text_res
    add     sp, 0x6
    push    dx
    push    ax
    mov     ax, 0x1
    push    ax
    mov     ax, 0x2
    push    ax
    call    far ptr show_dialog
    add     sp, 0x12
    mov     si, ax
    or      si, si
    jnz     LAB_2a2b_1635
    jmp     near ptr LAB_2a2b_14b6
LAB_2a2b_1635:
    mov     byte ptr [bp+var_188], 0x0
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_163e:
    cmp     byte ptr [bp+var_C6], 0x0
    jz      LAB_2a2b_1648
    jmp     near ptr LAB_2a2b_16de
LAB_2a2b_1648:
    mov     al, byte ptr [bp+var_DA]
    cmp     byte ptr [bp+var_18E], al
    jnz     LAB_2a2b_1678
    mov     al, byte ptr [bp+var_C0]
    cmp     byte ptr [bp+var_180], al
    jnz     LAB_2a2b_1678
    mov     al, byte ptr [bp+var_190]
    mov     byte ptr [bp+var_1C], al
    mov     al, byte ptr [bp+var_192]
    mov     byte ptr [bp+var_190], al
    mov     al, byte ptr [bp+var_1C]
    mov     byte ptr [bp+var_192], al
    inc     byte ptr [bp+var_A]
    jmp     LAB_2a2b_16ab
    db 0x90
LAB_2a2b_1678:
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_192], al
    mov     al, byte ptr [bp+var_18E]
    mov     byte ptr [bp+var_DA], al
    mov     al, byte ptr [bp+var_180]
    mov     byte ptr [bp+var_C0], al
LAB_2a2b_16ab:
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     al, byte ptr [bp+var_190]
    mov     byte ptr es:[bx], al
    mov     byte ptr [bp+var_D4], 0x1
    mov     byte ptr [bp+var_30], 0x1
    inc     byte ptr [bp+var_32]
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_16de:
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x1
    jz      LAB_2a2b_1701
    cmp     byte ptr [bp+var_180], 0x1c
    jle     LAB_2a2b_1701
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1701:
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    test    byte ptr [bx+trkObjectList.ss_multiTileFlag], 0x2
    jz      LAB_2a2b_1724
    cmp     byte ptr [bp+var_18E], 0x1c
    jle     LAB_2a2b_1724
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1724:
    mov     al, byte ptr [bp+var_DA]
    cmp     byte ptr [bp+var_18E], al
    jnz     LAB_2a2b_1754
    mov     al, byte ptr [bp+var_C0]
    cmp     byte ptr [bp+var_180], al
    jnz     LAB_2a2b_1754
    mov     al, byte ptr [bp+var_190]
    mov     byte ptr [bp+var_1C], al
    mov     al, byte ptr [bp+var_192]
    mov     byte ptr [bp+var_190], al
    mov     al, byte ptr [bp+var_1C]
    mov     byte ptr [bp+var_192], al
    inc     byte ptr [bp+var_A]
    jmp     LAB_2a2b_1790
    db 0x90
LAB_2a2b_1754:
    mov     al, byte ptr [bp+var_180]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_18E]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_192], al
    cmp     al, 0xfd
    jc      LAB_2a2b_1780
    mov     byte ptr [bp+var_192], 0x0
LAB_2a2b_1780:
    mov     al, byte ptr [bp+var_18E]
    mov     byte ptr [bp+var_DA], al
    mov     al, byte ptr [bp+var_180]
    mov     byte ptr [bp+var_C0], al
LAB_2a2b_1790:
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr [bp+var_190]
    mov     byte ptr es:[bx], al
    mov     byte ptr [bp+var_D4], 0x1
    mov     byte ptr [bp+var_30], 0x1
    inc     byte ptr [bp+var_32]
    mov     al, byte ptr [bp+var_190]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, byte ptr [bx+trkObjectList.ss_multiTileFlag]
    cbw
    cmp     ax, 0x1
    jz      LAB_2a2b_17e8
    cmp     ax, 0x2
    jz      LAB_2a2b_180c
    cmp     ax, 0x3
    jz      LAB_2a2b_1830
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_17e8:
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+(trackrows+1*2)]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     byte ptr es:[bx], 0xfe
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_180c:
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     byte ptr es:[bx+0x1], 0xff
    jmp     near ptr LAB_2a2b_11e1
LAB_2a2b_1830:
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     byte ptr es:[bx+0x1], 0xff
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+(trackrows+1*2)]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     byte ptr es:[bx], 0xfe
    mov     al, byte ptr [bp+var_C0]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    mov     bx, word ptr [bx+(trackrows+1*2)]
    mov     al, byte ptr [bp+var_DA]
    cbw
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     byte ptr es:[bx+0x1], 0xfd
    jmp     near ptr LAB_2a2b_11e1
    db 0x90
LAB_2a2b_1896:
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_18a4
    mov     byte ptr [bp+var_17F], 0x0
    jmp     near ptr LAB_2a2b_1a18
LAB_2a2b_18a4:
    mov     al, byte ptr [bp+var_18C]
    cmp     byte ptr [bp+var_180], al
    jnz     LAB_2a2b_18c0
    mov     al, byte ptr [bp+var_8]
    cmp     byte ptr [bp+var_18E], al
    jnz     LAB_2a2b_18c0
    mov     byte ptr [bp+var_8], 0x0
    mov     byte ptr [bp+var_18C], 0x0
LAB_2a2b_18c0:
    mov     al, byte ptr [bp+var_18C]
    mov     byte ptr [bp+var_180], al
    mov     al, byte ptr [bp+var_8]
    mov     byte ptr [bp+var_18E], al
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_18d2:
    mov     al, byte ptr [bp+var_34]
    cbw
    add     ax, bp
    sub     ax, 0x180
    mov     word ptr [bp+var_196], ax
    mov     bx, ax
    cmp     byte ptr [bx], 0x0
    jnz     LAB_2a2b_18e9
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_18e9:
    mov     byte ptr [bp+var_DA], 0xff
    dec     byte ptr [bx]
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_18f9
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_18f9:
    cmp     byte ptr [bp+var_17F], 0x6
    jl      LAB_2a2b_1903
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1903:
    jmp     LAB_2a2b_1923
    db 0x90
LAB_2a2b_1906:
    mov     al, byte ptr [bp+var_196]
    mov     byte ptr [bp+var_178], al
    cmp     al, 0xff
    jnz     LAB_2a2b_1918
    dec     byte ptr [bp+var_18D]
    jmp     LAB_2a2b_1923
LAB_2a2b_1918:
    cmp     byte ptr [bp+var_178], 0xfe
    jnz     LAB_2a2b_1923
    dec     byte ptr [bp+var_17F]
LAB_2a2b_1923:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_196], al
    cmp     al, 0xfe
    jnc     LAB_2a2b_1906
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_1956:
    mov     al, byte ptr [bp+var_34]
    cbw
    mov     word ptr [bp+var_196], ax
    mov     bx, ax
    mov     al, byte ptr [bx+byte_3ED00]
    add     bx, bp
    cmp     byte ptr [bx+0xfe80], al
    jc      LAB_2a2b_196f
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_196f:
    mov     byte ptr [bp+var_DA], 0xff
    mov     bx, word ptr [bp+var_196]
    add     bx, bp
    inc     byte ptr [bx+0xfe80]
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_1987
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1987:
    cmp     byte ptr [bp+var_17F], 0x6
    jl      LAB_2a2b_1991
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1991:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_178], al
    cmp     al, 0xff
    jnz     LAB_2a2b_19c8
    dec     byte ptr [bp+var_18D]
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_19c8:
    cmp     byte ptr [bp+var_178], 0xfe
    jz      LAB_2a2b_19d2
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_19d2:
    inc     byte ptr [bp+var_17F]
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_19da:
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_19ea
    cmp     byte ptr [bp+var_17F], 0x6
    jnz     LAB_2a2b_19ea
    jmp     near ptr LAB_2a2b_1108
LAB_2a2b_19ea:
    mov     al, byte ptr [bp+var_34]
    cbw
    add     ax, bp
    sub     ax, 0x18e
    mov     word ptr [bp+var_196], ax
    mov     bx, ax
    cmp     byte ptr [bx], 0x0
    jnz     LAB_2a2b_1a01
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1a01:
    mov     byte ptr [bp+var_DA], 0xff
    dec     byte ptr [bx]
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_1a11
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1a11:
    cmp     byte ptr [bp+var_17F], 0x5
    jle     LAB_2a2b_1a3d
LAB_2a2b_1a18:
    mov     byte ptr [bp+var_18D], 0x0
    jmp     near ptr LAB_2a2b_1b8a
LAB_2a2b_1a20:
    mov     al, byte ptr [bp+var_196]
    mov     byte ptr [bp+var_178], al
    cmp     al, 0xff
    jnz     LAB_2a2b_1a32
    dec     byte ptr [bp+var_18D]
    jmp     LAB_2a2b_1a3d
LAB_2a2b_1a32:
    cmp     byte ptr [bp+var_178], 0xfe
    jnz     LAB_2a2b_1a3d
    dec     byte ptr [bp+var_17F]
LAB_2a2b_1a3d:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_196], al
    cmp     al, 0xfe
    jnc     LAB_2a2b_1a20
    jmp     near ptr LAB_2a2b_1b8a
    db 0x90
LAB_2a2b_1a70:
    cmp     byte ptr [bp+var_34], 0x0
    jz      LAB_2a2b_1a80
    cmp     byte ptr [bp+var_17F], 0x6
    jnz     LAB_2a2b_1a80
    jmp     near ptr LAB_2a2b_111a
LAB_2a2b_1a80:
    mov     byte ptr [bp+var_178], 0x1
    cmp     byte ptr [bp+var_34], 0x0
    jnz     LAB_2a2b_1a8e
    jmp     near ptr LAB_2a2b_1b18
LAB_2a2b_1a8e:
    cmp     byte ptr [bp+var_17F], 0x5
    jle     LAB_2a2b_1aeb
    mov     byte ptr [bp+var_178], 0x3
    jmp     LAB_2a2b_1b18
    db 2 dup (0x90)
LAB_2a2b_1a9e:
    mov     al, byte ptr [bp+var_17F]
    cbw
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, 0x24
    imul    byte ptr [bp+var_C6]
    add     bx, ax
    mov     al, byte ptr [bp+var_18D]
    cbw
    add     bx, ax
    add     bx, word ptr [bp+var_196]
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx]
    mov     byte ptr [bp+var_198], al
    cmp     al, 0xfe
    jc      LAB_2a2b_1b18
    mov     byte ptr [bp+var_186], al
    cmp     al, 0xff
    jnz     LAB_2a2b_1ae0
    inc     byte ptr [bp+var_178]
    jmp     LAB_2a2b_1aeb
    db 0x90
LAB_2a2b_1ae0:
    cmp     byte ptr [bp+var_186], 0xfe
    jnz     LAB_2a2b_1aeb
    dec     byte ptr [bp+var_17F]
LAB_2a2b_1aeb:
    mov     al, byte ptr [bp+var_178]
    sub     ah, ah
    mov     word ptr [bp+var_196], ax
    mov     al, byte ptr [bp+var_34]
    cbw
    mov     word ptr [bp+var_194], ax
    mov     bx, ax
    add     bx, bp
    mov     al, byte ptr [bx+0xfe72]
    cbw
    add     ax, word ptr [bp+var_196]
    mov     bx, word ptr [bp+var_194]
    mov     cl, byte ptr [bx+byte_3ECFE]
    sub     ch, ch
    cmp     ax, cx
    jc      LAB_2a2b_1a9e
LAB_2a2b_1b18:
    mov     al, byte ptr [bp+var_34]
    cbw
    mov     word ptr [bp+var_198], ax
    mov     bx, ax
    add     bx, bp
    mov     al, byte ptr [bx+0xfe72]
    cbw
    mov     cl, byte ptr [bp+var_178]
    sub     ch, ch
    add     ax, cx
    mov     bx, word ptr [bp+var_198]
    mov     cl, byte ptr [bx+byte_3ECFE]
    cmp     ax, cx
    jnc     LAB_2a2b_1b8a
    mov     byte ptr [bp+var_DA], 0xff
    add     bx, bp
    mov     al, byte ptr [bp+var_178]
    add     byte ptr [bx+0xfe72], al
    jmp     LAB_2a2b_1b8a
LAB_2a2b_1b4e:
    cmp     ax, 0x4b00
    jnz     LAB_2a2b_1b56
    jmp     near ptr LAB_2a2b_19da
LAB_2a2b_1b56:
    ja      LAB_2a2b_1b6a
    cmp     ax, 0x4700
    jnz     LAB_2a2b_1b60
    jmp     near ptr LAB_2a2b_1896
LAB_2a2b_1b60:
    cmp     ax, 0x4800
    jnz     LAB_2a2b_1b68
    jmp     near ptr LAB_2a2b_18d2
LAB_2a2b_1b68:
    jmp     LAB_2a2b_1b8a
LAB_2a2b_1b6a:
    cmp     ax, 0x4d00
    jnz     LAB_2a2b_1b72
    jmp     near ptr LAB_2a2b_1a70
LAB_2a2b_1b72:
    cmp     ax, 0x5000
    jnz     LAB_2a2b_1b7a
    jmp     near ptr LAB_2a2b_1956
LAB_2a2b_1b7a:
    cmp     ax, 0x5200
    jnz     LAB_2a2b_1b82
    jmp     near ptr LAB_2a2b_1100
LAB_2a2b_1b82:
    cmp     ax, 0x5400
    jnz     LAB_2a2b_1b8a
    jmp     near ptr LAB_2a2b_112c
LAB_2a2b_1b8a:
    cmp     byte ptr [bp+var_188], 0x0
    jz      LAB_2a2b_1b94
    jmp     near ptr LAB_2a2b_0470
LAB_2a2b_1b94:
    push    word ptr [wndsprite+2]
    push    word ptr [wndsprite]
    call    far ptr sprite_free_wnd
    add     sp, 0x4
    push    word ptr [bp+var_164]
    push    word ptr [bp+var_166]
    call    far ptr sprite_free_wnd
    add     sp, 0x4
    push    word ptr [bp+var_168]
    push    word ptr [bp+var_16A]
    call    far ptr sprite_free_wnd
    add     sp, 0x4
    push    word ptr [bp+var_16C]
    push    word ptr [bp+var_16E]
    call    far ptr sprite_free_wnd
    add     sp, 0x4
    push    word ptr [bp+var_170]
    push    word ptr [bp+var_172]
    call    far ptr sprite_free_wnd
    add     sp, 0x4
    push    word ptr [bp+var_20]
    push    word ptr [bp+var_22]
    call    far ptr unload_resource
    add     sp, 0x4
    push    word ptr [bp+var_28]
    push    word ptr [bp+var_2A]
    call    far ptr mmgr_free
    add     sp, 0x4
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
load_tracks_menu_shapes_asm_ endp

; void __cdecl16far preRender_icons(byte param_1)
preRender_icons_asm_ proc far
    var_6      = byte ptr   -6
    var_4      = byte ptr   -4
    var_2      = byte ptr   -2
    param_1    = byte ptr    6

    push    bp
    mov     bp, sp
    sub     sp, 0x6
    push    si
    mov     byte ptr [bp+var_2], 0x0
    jmp     near ptr LAB_2a2b_1de5
LAB_2a2b_1c14:
    cmp     byte ptr [bp+var_6], 0xfd
    jc      LAB_2a2b_1c1d
    jmp     near ptr LAB_2a2b_1cfc
LAB_2a2b_1c1d:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xdc
    push    ax
    push    word ptr [tracksmenushapes1+2]
    push    word ptr [tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    mov     al, byte ptr [bp+var_6]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, byte ptr [bx+trkObjectList.ss_multiTileFlag]
    cbw
    cmp     ax, 0x1
    jz      LAB_2a2b_1c72
    cmp     ax, 0x2
    jnz     LAB_2a2b_1c68
    jmp     near ptr LAB_2a2b_1d6a
LAB_2a2b_1c68:
    cmp     ax, 0x3
    jnz     LAB_2a2b_1c70
    jmp     near ptr LAB_2a2b_1d84
LAB_2a2b_1c70:
    jmp     LAB_2a2b_1c9a
LAB_2a2b_1c72:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x34
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xdc
LAB_2a2b_1c89:
    push    ax
    push    word ptr [tracksmenushapes1+2]
    push    word ptr [tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
LAB_2a2b_1c9a:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xdc
    push    ax
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr putpixel_iconMask          ; renders the "surroundings"
    add     sp, 0x8
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xdc
    push    ax
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk+2]
    push    word ptr [bx+tracksmenushape2dunk]
    call    far ptr putpixel_iconFillings      ; renders the "filling" of the icons
LAB_2a2b_1cf9:
    add     sp, 0x8
LAB_2a2b_1cfc:
    inc     byte ptr [bp+var_4]
LAB_2a2b_1cff:
    cmp     byte ptr [bp+var_4], 0x6
    jc      LAB_2a2b_1d08
    jmp     near ptr LAB_2a2b_1de2
LAB_2a2b_1d08:
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    mov     si, ax
    mov     al, byte ptr [bp+var_2]
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    shl     ax, 0x1
    mov     cx, ax
    mov     al, 0x24
    mul     byte ptr [bp+param_1]
    mov     bx, ax
    add     bx, cx
    add     bx, word ptr [pboxshape]
    mov     es, word ptr [pboxshape+2]
    mov     al, byte ptr es:[bx+si]
    mov     byte ptr [bp+var_6], al
    cmp     byte ptr [bp+param_1], 0x0
    jz      LAB_2a2b_1d3c
    jmp     near ptr LAB_2a2b_1c14
LAB_2a2b_1d3c:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0xdc
    push    ax
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    jmp     LAB_2a2b_1cf9
    db 0x90
LAB_2a2b_1d6a:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
LAB_2a2b_1d76:
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xec
    jmp     near ptr LAB_2a2b_1c89
LAB_2a2b_1d84:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x24
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xec
    push    ax
    push    word ptr [tracksmenushapes1+2]
    push    word ptr [tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x34
    push    ax
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    shl     ax, cl
    add     ax, 0xdc
    push    ax
    push    word ptr [tracksmenushapes1+2]
    push    word ptr [tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x34
    jmp     LAB_2a2b_1d76
LAB_2a2b_1de2:
    inc     byte ptr [bp+var_2]
LAB_2a2b_1de5:
    cmp     byte ptr [bp+var_2], 0x6
    jnc     LAB_2a2b_1df2
    mov     byte ptr [bp+var_4], 0x0
    jmp     near ptr LAB_2a2b_1cff
LAB_2a2b_1df2:
    pop     si
    mov     sp, bp
    pop     bp
    retf
preRender_icons_asm_ endp
    db 0x90

; void __cdecl16far draw_2DtrackMap(byte param_1, byte param_2, int param_3, int param_4)
draw_2DtrackMap_asm_ proc far
    var_E      = word ptr  -14
    var_C      = byte ptr  -12
    var_A      = byte ptr  -10
    var_8      = byte ptr   -8
    var_6      = byte ptr   -6
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    param_1    = byte ptr    6
    param_2    = byte ptr    8
    param_3    = word ptr   10
    param_4    = word ptr   12

    push    bp
    mov     bp, sp
    sub     sp, 0xe
    push    di
    push    si
    mov     byte ptr [bp+var_6], 0x0
    jmp     near ptr LAB_2a2b_2547
    db 0x90
LAB_2a2b_1e08:
    cmp     byte ptr [bp+var_C], 0xfe
    jz      LAB_2a2b_1e11
    jmp     near ptr LAB_2a2b_1f6a
LAB_2a2b_1e11:
    cmp     byte ptr [bp+var_6], 0x0
    jz      LAB_2a2b_1e1a
    jmp     near ptr LAB_2a2b_1f6a
LAB_2a2b_1e1a:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x18
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx+0x1]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    sub     ax, 0xc
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr sprite_putimage_and
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    sub     ax, 0xc
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     bl, byte ptr es:[bx]
LAB_2a2b_1f51:
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk+2]
    push    word ptr [bx+tracksmenushape2dunk]
    call    far ptr sprite_putimage_or
LAB_2a2b_1f64:
    add     sp, 0x8
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_1f6a:
    cmp     byte ptr [bp+var_C], 0xfd
    jz      LAB_2a2b_1f73
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_1f73:
    cmp     byte ptr [bp+var_6], 0x0
    jz      LAB_2a2b_1f7c
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_1f7c:
    cmp     byte ptr [bp+var_8], 0x0
    jz      LAB_2a2b_1f85
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_1f85:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    sub     ax, 0xc
    push    ax
    mov     ax, si
    shl     ax, cl
    sub     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     bl, byte ptr es:[bx-0x1]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr sprite_putimage_and
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    sub     ax, 0xc
    push    ax
    mov     ax, si
    shl     ax, cl
    sub     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]       ; is really trackrows[bx -1]
LAB_2a2b_2055:
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     bl, byte ptr es:[bx-0x1]
    jmp     near ptr LAB_2a2b_1f51
    db 0x90
LAB_2a2b_206e:
    cmp     byte ptr [bp+var_C], 0x0
    jnz     LAB_2a2b_20d2
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_3]
    cmp     byte ptr [bx+si], 0x0
    jnz     LAB_2a2b_208c
    mov     si, word ptr [bp+param_4]
    mov     al, byte ptr [bp+var_A]
    cmp     byte ptr [bx+si], al
    jnz     LAB_2a2b_208c
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_208c:
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_A]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_3]
    mov     byte ptr [bx+si], 0x0
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_4]
    mov     al, byte ptr [bp+var_A]
    mov     byte ptr [bx+si], al
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_20d2:
    cmp     byte ptr [bp+var_C], 0xfd
    jc      LAB_2a2b_20db
    jmp     near ptr LAB_2a2b_237c
LAB_2a2b_20db:
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_3]
    mov     al, byte ptr [bp+var_C]
    cmp     byte ptr [bx+si], al
    jnz     LAB_2a2b_20f5
    mov     si, word ptr [bp+param_4]
    mov     al, byte ptr [bp+var_A]
    cmp     byte ptr [bx+si], al
    jnz     LAB_2a2b_20f5
    jmp     near ptr LAB_2a2b_238e
LAB_2a2b_20f5:
    mov     si, word ptr [bp+param_3]
    mov     al, byte ptr [bp+var_C]
    mov     byte ptr [bx+si], al
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_4]
    mov     al, byte ptr [bp+var_A]
    mov     byte ptr [bx+si], al
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_A]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_shape_to_1
    add     sp, 0x8
    mov     al, byte ptr [bp+var_C]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, byte ptr [bx+trkObjectList.ss_multiTileFlag]
    cbw
    or      ax, ax
    jz      LAB_2a2b_216a
    cmp     ax, 0x1
    jz      LAB_2a2b_21c8
    cmp     ax, 0x2
    jnz     LAB_2a2b_215e
    jmp     near ptr LAB_2a2b_2266
LAB_2a2b_215e:
    cmp     ax, 0x3
    jnz     LAB_2a2b_2166
    jmp     near ptr LAB_2a2b_22a8
LAB_2a2b_2166:
    jmp     near ptr LAB_2a2b_238e
    db 0x90
LAB_2a2b_216a:
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_C]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr putpixel_iconMask
    add     sp, 0x8
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_C]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk+2]
    push    word ptr [bx+tracksmenushape2dunk]
    call    far ptr putpixel_iconFillings
    jmp     near ptr LAB_2a2b_1f64
LAB_2a2b_21c8:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x14
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+(terrainrows+1*2)]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
LAB_2a2b_2205:
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_C]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr sprite_putimage_and
    add     sp, 0x8
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     al, byte ptr [bp+var_8]
    cbw
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+var_C]
    jmp     near ptr LAB_2a2b_1f51
LAB_2a2b_2266:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x18
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
LAB_2a2b_228f:
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx+0x1]
    jmp     near ptr LAB_2a2b_2205
    db 0x90
LAB_2a2b_22a8:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x18
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx+0x1]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x14
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+(terrainrows+1*2)]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x14
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x18
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+(terrainrows+1*2)]
    jmp     near ptr LAB_2a2b_228f
    db 0x90
LAB_2a2b_237c:
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_3]
    mov     byte ptr [bx+si], 0xff
    mov     bx, word ptr [bp+var_4]
    mov     si, word ptr [bp+param_4]
    mov     byte ptr [bx+si], 0xff
LAB_2a2b_238e:
    inc     byte ptr [bp+var_8]
LAB_2a2b_2391:
    cmp     byte ptr [bp+var_8], 0xc
    jl      LAB_2a2b_239a
    jmp     near ptr LAB_2a2b_2544
LAB_2a2b_239a:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cl, byte ptr [bp+param_2]
    sub     ch, ch
    add     ax, cx
    shl     ax, 0x1
    mov     word ptr [bp+var_E], ax
    mov     bx, ax
    mov     bx, word ptr [bx+trackrows]
    add     bx, si
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx+di]
    mov     byte ptr [bp+var_C], al
    mov     bx, word ptr [bp+var_E]
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     al, byte ptr es:[bx+di]
    mov     byte ptr [bp+var_A], al
    mov     ax, word ptr [bp+var_2]
    add     ax, si
    mov     word ptr [bp+var_4], ax
    cmp     byte ptr [bp+var_C], 0xfd
    jnc     LAB_2a2b_23f5
    jmp     near ptr LAB_2a2b_206e
LAB_2a2b_23f5:
    cmp     byte ptr [bp+var_6], ch
    jz      LAB_2a2b_2402
    cmp     byte ptr [bp+var_8], ch
    jz      LAB_2a2b_2402
    jmp     near ptr LAB_2a2b_206e
LAB_2a2b_2402:
    mov     bx, word ptr [bp+var_4]
    add     bx, word ptr [bp+param_3]
    mov     byte ptr [bx], 0xff
    cmp     byte ptr [bp+var_C], 0xff
    jz      LAB_2a2b_2414
    jmp     near ptr LAB_2a2b_1e08
LAB_2a2b_2414:
    cmp     byte ptr [bp+var_8], 0x0
    jz      LAB_2a2b_241d
    jmp     near ptr LAB_2a2b_1e08
LAB_2a2b_241d:
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+terrainrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x14
    push    ax
    mov     ax, si
    shl     ax, cl
    add     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+(terrainrows+1*2)]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     bl, byte ptr es:[bx]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushapes1+2]
    push    word ptr [bx+tracksmenushapes1]
    call    far ptr sprite_putimage_and_alt
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    sub     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    add     bx, si
    mov     al, byte ptr [bp+param_1]
    sub     ah, ah
    add     bx, ax
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     bl, byte ptr es:[bx-0x1]
    sub     bh, bh
    shl     bx, 0x1
    shl     bx, 0x1
    push    word ptr [bx+tracksmenushape2dunk2+2]
    push    word ptr [bx+tracksmenushape2dunk2]
    call    far ptr sprite_putimage_and
    add     sp, 0x8
    mov     al, byte ptr [bp+var_8]
    cbw
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     di, ax
    mov     cl, 0x4
    shl     ax, cl
    add     ax, 0x4
    push    ax
    mov     ax, si
    shl     ax, cl
    sub     ax, 0x8
    push    ax
    mov     bl, byte ptr [bp+param_2]
    sub     bh, bh
    add     bx, di
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    jmp     near ptr LAB_2a2b_2055
    db 0x90
LAB_2a2b_2544:
    inc     byte ptr [bp+var_6]
LAB_2a2b_2547:
    cmp     byte ptr [bp+var_6], 0xb
    jge     LAB_2a2b_2566
    mov     al, byte ptr [bp+var_6]
    cbw
    mov     cx, ax
    shl     ax, 0x1
    add     ax, cx
    shl     ax, 0x1
    shl     ax, 0x1
    mov     word ptr [bp+var_2], ax
    mov     byte ptr [bp+var_8], 0x0
    jmp     near ptr LAB_2a2b_2391
    db 0x90
LAB_2a2b_2566:
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
draw_2DtrackMap_asm_ endp

; byte __cdecl16far sub_2C81C(void)
sub_2C81C_asm_ proc far
    var_A      = byte ptr  -10
    var_8      = byte ptr   -8
    var_6      = byte ptr   -6
    var_4      = byte ptr   -4
    var_2      = byte ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0xa
    push    di
    push    si
    push    cs
    call    near ptr sub_2C9B4
    mov     byte ptr [bp+var_A], 0x0
    mov     byte ptr [bp+var_6], 0x0
    jmp     near ptr LAB_2a2b_26e3
    db 0x90
LAB_2a2b_2584:
    cmp     byte ptr [bp+var_4], 0xff
    jnz     LAB_2a2b_2598
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     si, word ptr [bx+trackrows]
    jmp     LAB_2a2b_25cb
    db 0x90
LAB_2a2b_2598:
    cmp     byte ptr [bp+var_4], 0xfe
    jnz     LAB_2a2b_25ba
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     bx, word ptr [bx+word_45D3E]
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    add     bx, ax
    les     si, [td14_elem_map_main]
    mov     al, byte ptr es:[bx+si]
    jmp     LAB_2a2b_25da
    db 0x90
LAB_2a2b_25ba:
    cmp     byte ptr [bp+var_4], 0xfd
    jnz     LAB_2a2b_25dd
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     si, word ptr [bx+word_45D3E]
LAB_2a2b_25cb:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    add     si, ax
    les     bx, [td14_elem_map_main]
    mov     al, byte ptr es:[bx+si-0x1]
LAB_2a2b_25da:
    mov     byte ptr [bp+var_4], al
LAB_2a2b_25dd:
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    cmp     ax, 0x22
    jc      LAB_2a2b_2600
    cmp     ax, 0x23
    jbe     LAB_2a2b_2653
    cmp     ax, 0x67
    jc      LAB_2a2b_2600
    cmp     ax, 0x6c
    jbe     LAB_2a2b_2653
    cmp     ax, 0xab
    jc      LAB_2a2b_2600
    cmp     ax, 0xae
    jbe     LAB_2a2b_2653
LAB_2a2b_2600:
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    add     bx, ax
    les     si, [td14_elem_map_main]
    mov     byte ptr es:[bx+si], ah
    mov     byte ptr [bp+var_A], 0xc
    jmp     LAB_2a2b_2653
    db 0x90
LAB_2a2b_2620:
    mov     al, byte ptr [bp+var_4]
    sub     ah, ah
    push    ax
    mov     al, byte ptr [bp+var_8]
    push    ax
    call    far ptr subst_hillroad_track
    add     sp, 0x4
    or      al, al
    jnz     LAB_2a2b_2653
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    add     bx, ax
    les     si, [td14_elem_map_main]
    mov     byte ptr es:[bx+si], ah
    mov     byte ptr [bp+var_A], 0xd
LAB_2a2b_2653:
    inc     byte ptr [bp+var_2]
LAB_2a2b_2656:
    cmp     byte ptr [bp+var_2], 0x1e
    jc      LAB_2a2b_265f
    jmp     near ptr LAB_2a2b_26e0
LAB_2a2b_265f:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    mov     si, ax
    mov     al, byte ptr [bp+var_6]
    mov     di, ax
    shl     di, 0x1
    mov     bx, word ptr [di+terrainrows]
    add     bx, word ptr [td15_terr_map_main]
    mov     es, word ptr [td15_terr_map_main+2]
    mov     al, byte ptr es:[bx+si]
    mov     byte ptr [bp+var_8], al
    mov     bx, word ptr [di+trackrows]
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    mov     al, byte ptr es:[bx+si]
    mov     byte ptr [bp+var_4], al
    cmp     al, ah
    jz      LAB_2a2b_2653
    cmp     byte ptr [bp+var_8], ah
    jz      LAB_2a2b_2653
    cmp     byte ptr [bp+var_8], 0x6
    jz      LAB_2a2b_2653
    mov     al, byte ptr [bp+var_8]
    cmp     ax, 0x1
    jc      LAB_2a2b_26bd
    cmp     ax, 0x5
    ja      LAB_2a2b_26b0
    jmp     near ptr LAB_2a2b_2584
LAB_2a2b_26b0:
    cmp     ax, 0x7
    jc      LAB_2a2b_26bd
    cmp     ax, 0xa
    ja      LAB_2a2b_26bd
    jmp     near ptr LAB_2a2b_2620
LAB_2a2b_26bd:
    mov     byte ptr [bp+var_A], 0xe
    mov     bl, byte ptr [bp+var_6]
    sub     bh, bh
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    add     bx, ax
    mov     si, word ptr [td14_elem_map_main]
    mov     byte ptr es:[bx+si], ah
    jmp     near ptr LAB_2a2b_2653
    db 0x90
    db 0x90
    db 0x90
LAB_2a2b_26e0:
    inc     byte ptr [bp+var_6]
LAB_2a2b_26e3:
    cmp     byte ptr [bp+var_6], 0x1e
    jnc     LAB_2a2b_26f0
    mov     byte ptr [bp+var_2], 0x0
    jmp     near ptr LAB_2a2b_2656
LAB_2a2b_26f0:
    cmp     byte ptr [bp+var_A], 0x0
    jz      LAB_2a2b_26fa
    push    cs
    call    near ptr sub_2C9B4
LAB_2a2b_26fa:
    mov     al, byte ptr [bp+var_A]
    cbw
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_2C81C_asm_ endp

; undefined __cdecl16far sub_2C9B4(void)
sub_2C9B4_asm_ proc far
    var_392    = dword ptr -914
    var_38E    = word ptr  -910
    var_38C    = byte ptr  -908
    var_38A    = byte ptr  -906
    var_388    = byte ptr  -904
    var_384    = byte ptr  -900
    var_383    = byte ptr  -899

    push    bp
    mov     bp, sp
    sub     sp, 0x392
    push    di
    push    si
    sub     si, si
LAB_2a2b_270f:
    mov     byte ptr [bp+si+0xfc7c], 0x0
    inc     si
    cmp     si, 0x384
    jl      LAB_2a2b_270f
    mov     byte ptr [bp+var_38C], 0x0
    jmp     near ptr LAB_2a2b_298c
    db 0x90
LAB_2a2b_2724:
    mov     al, byte ptr [bp+var_38A]
    sub     ah, ah
    mov     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    add     bx, ax
    shl     bx, 0x1
    mov     al, byte ptr [bx+trkObjectList.ss_multiTileFlag]
    cbw
    cmp     ax, 0x1
    jz      LAB_2a2b_2752
    cmp     ax, 0x2
    jnz     LAB_2a2b_2748
    jmp     near ptr LAB_2a2b_280c
LAB_2a2b_2748:
    cmp     ax, 0x3
    jnz     LAB_2a2b_2750
    jmp     near ptr LAB_2a2b_2880
LAB_2a2b_2750:
    jmp     LAB_2a2b_27c9
LAB_2a2b_2752:
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_38C]
    shl     ax, 0x1
    mov     word ptr [bp+var_38E], ax
    mov     bx, ax
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, di
    add     bx, bp
    cmp     byte ptr [bx+0xfc7c], 0x0
    jz      LAB_2a2b_277a
    mov     bx, ax
    jmp     near ptr LAB_2a2b_28ce
LAB_2a2b_277a:
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_38C]
    shl     ax, 0x1
    mov     word ptr [bp+var_38E], ax
    mov     bx, ax
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    cmp     byte ptr es:[bx+di], 0xfe
    jz      LAB_2a2b_27b0
    mov     bx, ax
    mov     bx, word ptr [bx+trackrows]
    add     bx, word ptr [td14_elem_map_main]
LAB_2a2b_27aa:
    mov     byte ptr es:[bx+di], 0x0
    jmp     LAB_2a2b_27c9
LAB_2a2b_27b0:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     di, word ptr [bx+(trackrows+1*2)]
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    add     di, ax
    mov     byte ptr [bp+di+0xfc7c], 0x1
LAB_2a2b_27c9:
    inc     byte ptr [bp+var_388]
LAB_2a2b_27cd:
    cmp     byte ptr [bp+var_388], 0x1e
    jc      LAB_2a2b_27d7
    jmp     near ptr LAB_2a2b_2988
LAB_2a2b_27d7:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     di, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    add     di, ax
    les     bx, [td14_elem_map_main]
    mov     al, byte ptr es:[bx+di]
    mov     byte ptr [bp+var_38A], al
    cmp     al, ah
    jz      LAB_2a2b_27c9
    cmp     al, 0xfd
    jnc     LAB_2a2b_2801
    jmp     near ptr LAB_2a2b_2724
LAB_2a2b_2801:
    cmp     byte ptr [bp+di+0xfc7c], ah
    jnz     LAB_2a2b_27c9
LAB_2a2b_2807:
    mov     byte ptr es:[bx+di], ah
    jmp     LAB_2a2b_27c9
LAB_2a2b_280c:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     di, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    add     di, ax
    cmp     byte ptr [bp+di+0xfc7d], ah
    jz      LAB_2a2b_282e
    les     bx, [td14_elem_map_main]
    jmp     near ptr LAB_2a2b_27aa
    db 0x90
LAB_2a2b_282e:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     ax, word ptr [bx+trackrows]
    mov     cl, byte ptr [bp+var_388]
    sub     ch, ch
    add     ax, cx
    add     ax, word ptr [td14_elem_map_main]
    mov     dx, word ptr [td14_elem_map_main+2]
    mov     word ptr [bp+var_392], ax
    mov     word ptr [bp+var_392+2], dx
    les     bx, [bp+var_392]
    cmp     byte ptr es:[bx+0x1], 0xff
    jz      LAB_2a2b_2864
    mov     byte ptr es:[bx], ch
    jmp     near ptr LAB_2a2b_27c9
    db 0x90
LAB_2a2b_2864:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     di, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    add     di, ax
    mov     byte ptr [bp+di+0xfc7d], 0x1
    jmp     near ptr LAB_2a2b_27c9
LAB_2a2b_2880:
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_38C]
    shl     ax, 0x1
    mov     word ptr [bp+var_392], ax
    mov     bx, ax
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, di
    add     bx, bp
    mov     al, byte ptr [bx+0xfc7d]
    sub     ah, ah
    mov     bx, word ptr [bp+var_392]
    mov     bx, word ptr [bx+trackrows]
    add     bx, di
    add     bx, bp
    mov     cl, byte ptr [bx+0xfc7d]
    sub     ch, ch
    add     ax, cx
    mov     bx, word ptr [bp+var_392]
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, di
    add     bx, bp
    mov     cl, byte ptr [bx+0xfc7c]
    add     ax, cx
    jz      LAB_2a2b_28de
    mov     bx, word ptr [bp+var_392]
LAB_2a2b_28ce:
    mov     bx, word ptr [bx+trackrows]
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    jmp     near ptr LAB_2a2b_27aa
    db 0x90
LAB_2a2b_28de:
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_38C]
    shl     ax, 0x1
    mov     word ptr [bp+var_392], ax
    mov     bx, ax
    mov     bx, word ptr [bx+trackrows]
    add     bx, word ptr [td14_elem_map_main]
    mov     es, word ptr [td14_elem_map_main+2]
    cmp     byte ptr es:[bx+di+0x1], 0xff
    jnz     LAB_2a2b_2926
    mov     bx, ax
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, word ptr [td14_elem_map_main]
    cmp     byte ptr es:[bx+di], 0xfe
    jnz     LAB_2a2b_2926
    mov     bx, ax
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, word ptr [td14_elem_map_main]
    cmp     byte ptr es:[bx+di+0x1], 0xfd
    jz      LAB_2a2b_2942
LAB_2a2b_2926:
    mov     bl, byte ptr [bp+var_38C]
    sub     bh, bh
    shl     bx, 0x1
    mov     bx, word ptr [bx+trackrows]
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    add     bx, ax
    mov     di, word ptr [td14_elem_map_main]
    jmp     near ptr LAB_2a2b_2807
    db 0x90
LAB_2a2b_2942:
    mov     al, byte ptr [bp+var_388]
    sub     ah, ah
    mov     di, ax
    mov     al, byte ptr [bp+var_38C]
    shl     ax, 0x1
    mov     word ptr [bp+var_392], ax
    mov     bx, ax
    mov     bx, word ptr [bx+trackrows]
    add     bx, di
    add     bx, bp
    mov     byte ptr [bx+0xfc7d], 0x1
    mov     bx, word ptr [bp+var_392]
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, di
    add     bx, bp
    mov     byte ptr [bx+0xfc7c], 0x1
    mov     bx, word ptr [bp+var_392]
    mov     bx, word ptr [bx+(trackrows+1*2)]
    add     bx, di
    add     bx, bp
    mov     byte ptr [bx+0xfc7d], 0x1
    jmp     near ptr LAB_2a2b_27c9
LAB_2a2b_2988:
    inc     byte ptr [bp+var_38C]
LAB_2a2b_298c:
    cmp     byte ptr [bp+var_38C], 0x1e
    jnc     LAB_2a2b_299c
    mov     byte ptr [bp+var_388], 0x0
    jmp     near ptr LAB_2a2b_27cd
    db 0x90
LAB_2a2b_299c:
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_2C9B4_asm_ endp

seg009 ends
end
