; Generated by restunts-export.py (Ghidra)
.8086
.model medium

include seg028.inc

seg028 segment byte public use16 'STUNTSC'
    assume cs:seg028, es:nothing, ss:nothing, ds:dseg

; void __cdecl16far audiodriver_timer(void)
audiodriver_timer_asm_ proc far
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, word ptr [audiodriverbinary]
    or      ax, word ptr [audiodriverbinary+2]
    jz      not_initialised
    cmp     word ptr [word_4063A], 0x0
    jnz     not_initialised
    cmp     word ptr [word_407AA], 0x0
    jnz     not_initialised
    inc     word ptr [word_407AA]
    push    cs
    call    near ptr sub_39700
    cmp     byte ptr [byte_40632], 0x1
    jnz     LAB_3863_004c
    cmp     byte ptr [audioflag2], 0x1
    jnz     LAB_3863_004c
    cmp     byte ptr [byte_40630], 0x0
    jnz     LAB_3863_004c
    push    cs
    call    near ptr sub_3868A
    jmp     LAB_3863_0050
LAB_3863_004c:
    push    cs
    call    near ptr sub_3963C
LAB_3863_0050:
    push    cs
    call    near ptr sub_386D6
    dec     word ptr [word_407AA]
not_initialised:
    pop     ds
    retf
audiodriver_timer_asm_ endp

; void __cdecl16far sub_3868A(void)
sub_3868A_asm_ proc far
    var_2      = byte ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0x2
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    add     word ptr [word_44D48], 0x80
    jmp     LAB_3863_0086
LAB_3863_006e:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    push    ax
    push    cs
    call    near ptr sub_38702
    add     sp, 0x2
    inc     byte ptr [bp+var_2]
LAB_3863_007e:
    mov     al, byte ptr [byte_44290]
    cmp     byte ptr [bp+var_2], al
    jc      LAB_3863_006e
LAB_3863_0086:
    mov     ax, word ptr [word_454BA]
    cmp     word ptr [word_44D48], ax
    jc      LAB_3863_00a0
    push    cs
    call    near ptr sub_3963C
    mov     ax, word ptr [word_454BA]
    sub     word ptr [word_44D48], ax
    mov     byte ptr [bp+var_2], 0x0
    jmp     LAB_3863_007e
LAB_3863_00a0:
    pop     ds
    mov     sp, bp
    pop     bp
    retf
sub_3868A_asm_ endp
    db 0x90

; void __cdecl16far sub_386D6(void)
sub_386D6_asm_ proc far
    var_2      = byte ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0x2
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     byte ptr [bp+var_2], 0x10
LAB_3863_00b6:
    mov     al, byte ptr [bp+var_2]
    sub     ah, ah
    push    ax
    push    cs
    call    near ptr sub_38702
    add     sp, 0x2
    inc     byte ptr [bp+var_2]
    cmp     byte ptr [bp+var_2], 0x17
    jc      LAB_3863_00b6
    pop     ds
    mov     sp, bp
    pop     bp
    retf
sub_386D6_asm_ endp
    db 0x90

; byte * __cdecl16far sub_38702(void)
sub_38702_asm_ proc far
    var_E      = byte ptr  -14
    var_C      = dword ptr -12
    var_8      = dword ptr  -8
    var_4      = word ptr   -4
    var_2      = byte ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0xe
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     byte ptr [bp+var_2], 0x0
    mov     ax, 0x4c
    imul    word ptr [bp+0x6]
    add     ax, 0x81fc
    mov     word ptr [bp+var_4], ax
    mov     bx, ax
    mov     ax, word ptr [bx+0x18]
    or      ax, word ptr [bx+0x1a]
    jz      LAB_3863_00fd
    jmp     near ptr LAB_3863_0468
LAB_3863_00fd:
    mov     ax, word ptr [bx]
    or      ax, word ptr [bx+0x2]
    jnz     LAB_3863_0107
    jmp     near ptr LAB_3863_0470
LAB_3863_0107:
    mov     ax, word ptr [bx+0x18]
    or      ax, word ptr [bx+0x1a]
    jz      LAB_3863_0112
    jmp     near ptr LAB_3863_0468
LAB_3863_0112:
    mov     ax, word ptr [bx]
    or      ax, word ptr [bx+0x2]
    jnz     LAB_3863_011c
    jmp     near ptr LAB_3863_0468
LAB_3863_011c:
    push    word ptr [bx+0x2]
    push    word ptr [bx]
    mov     ax, 0x728e
    push    ax
    push    cs
    call    near ptr sub_3945A
    add     sp, 0x6
    mov     bx, word ptr [bp+var_4]
    mov     al, byte ptr [byte_42A08]
    sub     ah, ah
    add     word ptr [bx], ax
    cmp     byte ptr [byte_42A02], 0xd9
    jnc     LAB_3863_0140
    jmp     near ptr LAB_3863_0414
LAB_3863_0140:
    mov     al, byte ptr [byte_42A03]
    mov     byte ptr [bp+var_2], al
    mov     al, byte ptr [byte_42A02]
    sub     ax, 0xd9
    cmp     ax, 0x11
    jbe     LAB_3863_0154
    jmp     near ptr LAB_3863_0437
LAB_3863_0154:
    add     ax, ax
    xchg    ax, bx
    jmp     word ptr cs:[bx+off_38A1E]
LAB_3863_015c:
    mov     bx, word ptr [bp-0x4]
    cmp     byte ptr [bx+0x4], 0x0
    jz      LAB_3863_0182
    mov     si, word ptr [bx+0x4]
    and     si, 0xff
    shl     si, 0x1
    shl     si, 0x1
    mov     ax, word ptr [bx+si+0x5]
    mov     dx, word ptr [bx+si+0x7]
    mov     word ptr [bx], ax
    mov     word ptr [bx+0x2], dx
    dec     byte ptr [bx+0x4]
    jmp     near ptr LAB_3863_0437
    db 0x90
LAB_3863_0182:
    mov     ax, word ptr [bx+0x48]
    mov     dx, word ptr [bx+0x4a]
    mov     word ptr [bp-0x8], ax
    mov     word ptr [bp-0x6], dx
    sub     ax, ax
    mov     word ptr [bx+0x2], ax
    mov     word ptr [bx], ax
    push    word ptr [bp+0x6]
    push    word ptr [bp+0x6]
    push    cs
    call    near ptr audio_driver_func1E
    add     sp, 0x4
LAB_3863_01a2:
    mov     ax, word ptr [bp-0x8]
    or      ax, word ptr [bp-0x6]
    jnz     LAB_3863_01ad
    jmp     near ptr LAB_3863_0437
LAB_3863_01ad:
    push    word ptr [bp+0x6]
    call    dword ptr [bp-0x8]
    add     sp, 0x2
    jmp     near ptr LAB_3863_0437
    db 0x90
LAB_3863_01ba:
    mov     ax, 0x717e
    push    ax
    mov     al, byte ptr [byte_42A08]
    sub     ah, ah
    sub     ax, 0x4
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x39
    mov     word ptr [bp-0xa], dx
    mov     word ptr [bp-0xc], ax
    call    dword ptr [bp-0xc]
    jmp     near ptr LAB_3863_0434
    db 0x90
LAB_3863_01de:
    mov     bx, word ptr [bp+0x6]
    mov     al, byte ptr [bp-0x2]
    mov     byte ptr [bx+byte_44D06], al
    jmp     near ptr LAB_3863_0437
    db 0x90
LAB_3863_01ec:
    mov     bx, word ptr [bp-0x4]
    inc     byte ptr [bx+0x4]
    mov     ax, word ptr [bx]
    mov     dx, word ptr [bx+0x2]
    mov     si, word ptr [bx+0x4]
    and     si, 0xff
    shl     si, 0x1
    shl     si, 0x1
    mov     word ptr [bx+si+0x5], ax
    mov     word ptr [bx+si+0x7], dx
    mov     ax, word ptr [word_42A04]
    mov     dx, word ptr [word_42A06]
    add     ax, 0x4
    jmp     LAB_3863_0269
LAB_3863_0214:
    mov     bx, word ptr [bp-0x4]
    sub     ax, ax
    mov     word ptr [bx+0x2], ax
    mov     word ptr [bx], ax
    mov     ax, word ptr [bx+0x48]
    mov     dx, word ptr [bx+0x4a]
    mov     word ptr [bp-0x8], ax
    mov     word ptr [bp-0x6], dx
    push    word ptr [bp+0x6]
    push    word ptr [bp+0x6]
    push    cs
    call    near ptr audio_driver_func1E
    add     sp, 0x4
    sub     ax, ax
    push    ax
    mov     al, byte ptr [byte_45950]
    sub     ah, ah
    push    ax
    sub     ax, ax
    push    ax
    push    ax
    push    ax
    push    word ptr [bp+0x6]
    push    word ptr [bp+0x6]
    call    far ptr audio_init_chunk
    add     sp, 0xe
    jmp     near ptr LAB_3863_01a2
LAB_3863_0256:
    mov     bx, word ptr [bp-0x4]
    mov     byte ptr [bx+0x4], 0x0
    mov     byte ptr [bx+0x32], 0x0
    mov     si, bx
    mov     ax, word ptr [si+0x5]
    mov     dx, word ptr [si+0x7]
LAB_3863_0269:
    mov     word ptr [bx], ax
    mov     word ptr [bx+0x2], dx
    jmp     near ptr LAB_3863_0437
    db 0x90
LAB_3863_0272:
    push    word ptr [bp-0x4]
    mov     al, byte ptr [bp-0x2]
    sub     ah, ah
    push    ax
    push    cs
    call    near ptr sub_38AC4
    add     sp, 0x4
    mov     bx, word ptr [bp-0x4]
    mov     word ptr [bx+0x1e], ax
    mov     word ptr [bx+0x20], dx
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_0295
    jmp     near ptr LAB_3863_0437
LAB_3863_0295:
    les     bx, [bx+0x1e]
    mov     al, byte ptr es:[bx+0x43]
    mov     byte ptr [bp-0xe], al
    cmp     al, 0x10
    jnc     LAB_3863_02a8
    mov     bx, word ptr [bp-0x4]
    jmp     LAB_3863_02b2
LAB_3863_02a8:
    mov     bx, word ptr [bp-0x4]
    mov     al, byte ptr [bp+0x6]
    and     al, 0xf
    inc     al
LAB_3863_02b2:
    mov     byte ptr [bx+0x47], al
    mov     al, byte ptr [bx+0x28]
    sub     ah, ah
    push    ax
    sub     ax, ax
    push    ax
    mov     al, byte ptr [bx+0x47]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x12
    mov     word ptr [bp-0xa], dx
    mov     word ptr [bp-0xc], ax
    call    dword ptr [bp-0xc]
    add     sp, 0x6
    mov     bx, word ptr [bp-0x4]
    push    word ptr [bx+0x20]
    push    word ptr [bx+0x1e]
    push    bx
    sub     ax, ax
    push    ax
    mov     al, byte ptr [bx+0x47]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x21
    mov     word ptr [bp-0xa], dx
    mov     word ptr [bp-0xc], ax
    call    dword ptr [bp-0xc]
    add     sp, 0xa
    jmp     near ptr LAB_3863_0437
LAB_3863_0306:
    cmp     word ptr [bp+0x6], 0x10
    jl      LAB_3863_030f
    jmp     near ptr LAB_3863_0437
LAB_3863_030f:
    mov     al, byte ptr [bp-0x2]
    sub     ah, ah
    mov     cx, ax
    mov     ax, 0x7d00
    cwd
    div     cx
    mov     word ptr [word_454BA], ax
    jmp     near ptr LAB_3863_0437
LAB_3863_0322:
    mov     al, byte ptr [bp-0x2]
    sub     ah, ah
    push    ax
    push    word ptr [bp+0x6]
    push    cs
    call    near ptr audio_unk2
    jmp     near ptr LAB_3863_0434
LAB_3863_0332:
    push    word ptr [word_42A04]
    mov     al, byte ptr [bp-0x2]
    sub     ah, ah
    push    ax
    push    word ptr [bp+0x6]
    push    cs
    call    near ptr sub_38AEA
    add     sp, 0x6
    jmp     near ptr LAB_3863_0437
    db 0x90
LAB_3863_034a:
    mov     bx, word ptr [bp-0x4]
    mov     al, byte ptr [bp-0x2]
    mov     byte ptr [bx+0x16], al
    jmp     near ptr LAB_3863_0437
LAB_3863_0356:
    mov     bx, word ptr [bp-0x4]
    mov     al, byte ptr [bp-0x2]
    mov     byte ptr [bx+0x24], al
    jmp     near ptr LAB_3863_0437
LAB_3863_0362:
    mov     bx, word ptr [bp-0x4]
    mov     ax, word ptr [bx]
    mov     dx, word ptr [bx+0x2]
    mov     si, word ptr [bx+0x32]
    and     si, 0xff
    shl     si, 0x1
    shl     si, 0x1
    mov     word ptr [bx+si+0x33], ax
    mov     word ptr [bx+si+0x35], dx
    mov     si, word ptr [bx+0x32]
    and     si, 0xff
    mov     al, byte ptr [bp-0x2]
    dec     al
    mov     byte ptr [bx+si+0x43], al
    inc     byte ptr [bx+0x32]
    jmp     near ptr LAB_3863_0437
LAB_3863_0390:
    mov     bx, word ptr [bp-0x4]
    cmp     byte ptr [bx+0x32], 0x0
    jnz     LAB_3863_039c
    jmp     near ptr LAB_3863_0437
LAB_3863_039c:
    mov     al, byte ptr [bx+0x32]
    sub     ah, ah
    mov     si, ax
    mov     di, bx
    mov     bx, si
    shl     bx, 0x1
    shl     bx, 0x1
    mov     ax, word ptr [bx+di+0x2f]
    mov     dx, word ptr [bx+di+0x31]
    mov     bx, di
    mov     word ptr [bx], ax
    mov     word ptr [bx+0x2], dx
    mov     al, byte ptr [bx+si+0x42]
    dec     byte ptr [bx+si+0x42]
    or      al, al
    jnz     LAB_3863_0437
    dec     byte ptr [bx+0x32]
    jmp     LAB_3863_0437
    db 0x90
LAB_3863_03c8:
    mov     bx, word ptr [bp-0x4]
    mov     al, byte ptr [bp-0x2]
    mov     byte ptr [bx+0x22], al
    jmp     LAB_3863_0437
    db 0x90
LAB_3863_03d4:
    mov     bx, word ptr [bp-0x4]
    mov     al, byte ptr [bp-0x2]
    mov     byte ptr [bx+0x47], al
    jmp     LAB_3863_0437
    db 0x90
LAB_3863_03e0:
    push    word ptr [word_42A04]
    push    word ptr [bp+0x6]
    push    cs
    call    near ptr sub_38BEA
    jmp     LAB_3863_0434
    db 0x90
off_38A1E:
    dw LAB_3863_015c
    dw LAB_3863_0214
    dw LAB_3863_0256
    dw LAB_3863_0272
    dw LAB_3863_0306
    dw LAB_3863_0322
    dw LAB_3863_0332
    dw LAB_3863_034a
    dw LAB_3863_0356
    dw LAB_3863_0362
    dw LAB_3863_0390
    dw LAB_3863_03c8
    dw LAB_3863_03e0
    dw LAB_3863_01ec
    dw LAB_3863_0437
    dw LAB_3863_01ba
    dw LAB_3863_03d4
    dw LAB_3863_01de
    jmp     LAB_3863_0437
LAB_3863_0414:
    cmp     byte ptr [byte_42A02], 0x80
    jnc     LAB_3863_0424
    mov     bx, word ptr [bp+var_4]
    mov     al, byte ptr [bx+0x22]
    mov     byte ptr [byte_42A03], al
LAB_3863_0424:
    and     byte ptr [byte_42A02], 0x7f
    push    word ptr [bp+0x6]
    mov     ax, 0x728e
    push    ax
    push    cs
    call    near ptr audio_drum_unk
LAB_3863_0434:
    add     sp, 0x4
LAB_3863_0437:
    mov     bx, word ptr [bp+var_4]
    mov     ax, word ptr [bx]
    or      ax, word ptr [bx+0x2]
    jnz     LAB_3863_0444
    jmp     near ptr LAB_3863_0107
LAB_3863_0444:
    push    word ptr [bx+0x2]
    push    word ptr [bx]
    mov     ax, 0x7282
    push    ax
    push    cs
    call    near ptr sub_3945A
    add     sp, 0x6
    mov     bx, word ptr [bp+var_4]
    mov     ax, word ptr [word_429F2]
    mov     dx, word ptr [word_429F4]
    mov     word ptr [bx+0x18], ax
    mov     word ptr [bx+0x1a], dx
    jmp     near ptr LAB_3863_0107
    db 0x90
LAB_3863_0468:
    sub     word ptr [bx+0x18], 0x1
    sbb     word ptr [bx+0x1a], 0x0
LAB_3863_0470:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_38702_asm_ endp
    db 0x90

; undefined __cdecl16far sub_38AA8(int param_1, byte param_2)
sub_38AA8_asm_ proc far
    param_1    = word ptr    6
    param_2    = byte ptr    8

    push    bp
    mov     bp, sp
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+param_1]
    mov     bx, ax
    mov     al, byte ptr [bp+param_2]
    mov     byte ptr [bx+(audiochunks_unk+71)], al
    pop     ds
    pop     bp
    retf
sub_38AA8_asm_ endp
    db 0x90

; undefined2 __cdecl16far sub_38AC4(uint param_1, int param_2)
sub_38AC4_asm_ proc far
    param_1    = word ptr    6
    param_2    = word ptr    8

    push    bp
    mov     bp, sp
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     si, word ptr [bp+param_1]
    and     si, 0xff
    shl     si, 0x1
    shl     si, 0x1
    mov     bx, word ptr [bp+param_2]
    les     bx, [bx+0x2e]
    mov     ax, word ptr es:[bx+si]
    mov     dx, word ptr es:[bx+si+0x2]
    pop     ds
    pop     si
    pop     bp
    retf
sub_38AC4_asm_ endp

; undefined __cdecl16far sub_38AEA(int param_1, char param_2, int param_3)
sub_38AEA_asm_ proc far
    var_12     = word ptr  -18
    var_10     = word ptr  -16
    var_E      = word ptr  -14
    var_A      = word ptr  -10
    var_8      = dword ptr  -8
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    param_1    = word ptr    6
    param_2    = byte ptr    8
    param_3    = word ptr   10

    push    bp
    mov     bp, sp
    sub     sp, 0x12
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+param_1]
    add     ax, 0x81fc
    mov     word ptr [bp+var_4], ax
    cmp     byte ptr [bp+param_2], 0x40
    jnz     LAB_3863_04e2
    mov     bx, ax
    mov     al, byte ptr [bp+param_3]
    mov     byte ptr [bx+0x25], al
LAB_3863_04e2:
    cmp     byte ptr [byte_40634], 0x0
    jz      LAB_3863_0514
    push    word ptr [bp+param_3]
    mov     al, byte ptr [bp+param_2]
    sub     ah, ah
    push    ax
    sub     ax, ax
    push    ax
    mov     bx, word ptr [bp+var_4]
    mov     al, byte ptr [bx+0x47]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x15
    mov     word ptr [bp+var_8+2], dx
    mov     word ptr [bp+var_8], ax
    call    dword ptr [bp+var_8]
    add     sp, 0x8
LAB_3863_0514:
    mov     word ptr [bp+var_2], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jnz     caseD_d
    jmp     near ptr LAB_3863_05b3
caseD_d:
    mov     al, byte ptr [bp+param_2]
    mov     word ptr [bp+var_A], ax
    mov     si, 0xa2b6
    mov     word ptr [bp+var_E], 0xa2b7
    mov     word ptr [bp+var_10], si
    mov     word ptr [bp+var_12], 0xa2cc
    mov     di, word ptr [bp+var_2]
LAB_3863_053e:
    mov     bx, word ptr [bp+var_4]
    mov     al, byte ptr [si]
    cmp     byte ptr [bx+0x23], al
    jnz     LAB_3863_056d
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_056d
    push    word ptr [bp+param_3]
    push    word ptr [bp+var_A]
    push    si
    push    di
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x15
    mov     word ptr [bp+var_8+2], dx
    mov     word ptr [bp+var_8], ax
    call    dword ptr [bp+var_8]
    add     sp, 0x8
LAB_3863_056d:
    cmp     byte ptr [bp+param_2], 0x40
    jnz     LAB_3863_0594
    cmp     word ptr [bp+param_3], 0x0
    jnz     LAB_3863_0594
    mov     bx, word ptr [bp+var_E]
    cmp     byte ptr [bx], 0x2
    jnz     LAB_3863_0594
    mov     bx, word ptr [bp+var_10]
    mov     al, byte ptr [bx]
    mov     bx, word ptr [bp+var_4]
    cmp     byte ptr [bx+0x23], al
    jnz     LAB_3863_0594
    mov     bx, word ptr [bp+var_12]
    mov     byte ptr [bx], 0x4
LAB_3863_0594:
    add     si, 0x2e
    add     word ptr [bp+var_E], 0x2e
    add     word ptr [bp+var_10], 0x2e
    add     word ptr [bp+var_12], 0x2e
    inc     di
    mov     ax, di
    mov     cl, byte ptr [byte_459D2]
    sub     ch, ch
    cmp     ax, cx
    jc      LAB_3863_053e
    mov     word ptr [bp+var_2], di
LAB_3863_05b3:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_38AEA_asm_ endp

; undefined __cdecl16far sub_38BEA(int param_1, uint param_2)
sub_38BEA_asm_ proc far
    var_6      = dword ptr  -6
    var_2      = word ptr   -2
    param_1    = word ptr    6
    param_2    = word ptr    8

    push    bp
    mov     bp, sp
    sub     sp, 0x6
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+param_1]
caseD_1:
    add     ax, 0x81fc
    mov     word ptr [bp+var_2], ax
    test    word ptr [bp+param_2], 0x100
    jz      LAB_3863_05dd
    or      byte ptr [bp+param_2], 0x80
LAB_3863_05dd:
    mov     al, byte ptr [bp+param_2]
    cbw
    mov     cx, word ptr [bp+param_2]
    sub     cl, cl
    shr     cx, 0x1
    add     cx, ax
    sub     cx, 0x2000
    mov     word ptr [bp+param_2], cx
caseD_b:
    mov     bx, word ptr [bp+var_2]
    mov     ax, cx
caseD_7_:
    mov     word ptr [bx+0x26], ax
    mov     al, byte ptr [bx+0x47]
    sub     ah, ah
    push    ax
    push    cx
    push    bx
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x1b
    mov     word ptr [bp+var_6+2], dx
    mov     word ptr [bp+var_6], ax
    call    dword ptr [bp+var_6]
    add     sp, 0x6
    pop     ds
    mov     sp, bp
    pop     bp
    retf
sub_38BEA_asm_ endp

; void __cdecl16far audio_unk2(uint chunk_idx, byte value)
audio_unk2_asm_ proc far
    var_C      = dword ptr -12
    var_6      = word ptr   -6
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    chunk_idx  = word ptr    6
    value      = byte ptr    8

    push    bp
    mov     bp, sp
    sub     sp, 0xc
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+chunk_idx]
    add     ax, offset audiochunks_unk
    mov     word ptr [bp+var_4], ax
    mov     bx, ax
    mov     al, byte ptr [bp+value]
    mov     byte ptr [bx+0x28], al
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_0698
    mov     word ptr [bp+var_2], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jz      LAB_3863_06c0
    mov     al, byte ptr [bp+value]
    mov     word ptr [bp+var_6], ax
    mov     si, offset unk_45A26
    mov     di, word ptr [bp+var_2]
LAB_3863_065f:
    mov     al, byte ptr [si]
    sub     ah, ah
    cmp     ax, word ptr [bp+chunk_idx]
    jnz     LAB_3863_0683
    push    word ptr [bp+var_6]
    push    si
    push    di
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x12
    mov     word ptr [bp+var_C+2], dx
    mov     word ptr [bp+var_C], ax
    call    dword ptr [bp+var_C]
    add     sp, 0x6
LAB_3863_0683:
    add     si, 0x2e
    inc     di
    mov     ax, di
    mov     cl, byte ptr [byte_459D2]
    sub     ch, ch
    cmp     ax, cx
    jc      LAB_3863_065f
    mov     word ptr [bp+var_2], di
    jmp     LAB_3863_06c0
LAB_3863_0698:
    mov     al, byte ptr [bp+value]
    sub     ah, ah
    push    ax
    sub     ax, ax
    push    ax
    mov     bx, word ptr [bp+var_4]
    mov     al, byte ptr [bx+0x47]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x12
    mov     word ptr [bp+var_C+2], dx
    mov     word ptr [bp+var_C], ax
    call    dword ptr [bp+var_C]
    add     sp, 0x6
LAB_3863_06c0:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
audio_unk2_asm_ endp
    db 0x90

; void __cdecl16far audio_unk4(uint chunk_idx, undefined4 param_2)
audio_unk4_asm_ proc far
    var_A      = dword ptr -10
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    chunk_idx  = word ptr    6
    param_2    = dword ptr   8

    push    bp
    mov     bp, sp
    sub     sp, 0xa
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+chunk_idx]
    mov     si, ax
    mov     ax, word ptr [bp+param_2]
    mov     dx, word ptr [bp+param_2+2]
    mov     word ptr [si+(audiochunks_unk+30)], ax
    mov     word ptr [si+(audiochunks_unk+32)], dx
    les     bx, [bp+param_2]
    cmp     byte ptr es:[bx+0x43], 0x10
    jnc     LAB_3863_0700
    mov     al, byte ptr es:[bx+0x43]
    mov     byte ptr [si+(audiochunks_unk+71)], al
    jmp     LAB_3863_0713
LAB_3863_0700:
    mov     ax, 0x4c
    imul    word ptr [bp+chunk_idx]
    mov     bx, ax
    mov     al, byte ptr [bp+chunk_idx]
    and     al, 0xf
    inc     al
    mov     byte ptr [bx+(audiochunks_unk+71)], al
LAB_3863_0713:
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_077c
    mov     word ptr [bp+var_2], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jnz     LAB_3863_072b
    jmp     near ptr LAB_3863_07ae
LAB_3863_072b:
    mov     ax, 0x4c
    imul    word ptr [bp+chunk_idx]
    add     ax, 0x81fc
    mov     word ptr [bp+var_4], ax
    mov     si, 0xa2b6
    mov     di, word ptr [bp+var_2]
LAB_3863_073d:
    mov     al, byte ptr [si]
    sub     ah, ah
    cmp     ax, word ptr [bp+chunk_idx]
    jnz     LAB_3863_0767
    push    word ptr [bp+param_2+2]
    push    word ptr [bp+param_2]
    push    word ptr [bp+var_4]
    push    si
    push    di
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x21
    mov     word ptr [bp+var_A+2], dx
    mov     word ptr [bp+var_A], ax
    call    dword ptr [bp+var_A]
    add     sp, 0xa
LAB_3863_0767:
    add     si, 0x2e
    inc     di
    mov     ax, di
    mov     cl, byte ptr [byte_459D2]
    sub     ch, ch
    cmp     ax, cx
    jc      LAB_3863_073d
    mov     word ptr [bp+var_2], di
    jmp     LAB_3863_07ae
LAB_3863_077c:
    mov     ax, 0x4c
    imul    word ptr [bp+chunk_idx]
    mov     si, ax
    push    word ptr [bp+param_2+2]
    push    word ptr [bp+param_2]
    add     ax, 0x81fc
    push    ax
    sub     ax, ax
    push    ax
    mov     al, byte ptr [si+(audiochunks_unk+71)]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x21
    mov     word ptr [bp+var_A+2], dx
    mov     word ptr [bp+var_A], ax
    call    dword ptr [bp+var_A]
    add     sp, 0xa
LAB_3863_07ae:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
audio_unk4_asm_ endp
    db 0x90

; byte * __cdecl16far audio_drum_unk(word param_1, word param_2)
audio_drum_unk_asm_ proc far
    var_12     = dword ptr -18
    var_E      = dword ptr -14
    var_A      = word ptr  -10
    var_8      = word ptr   -8
    var_6      = word ptr   -6
    var_4      = dword ptr  -4
    param_1    = word ptr    6
    param_2    = word ptr    8

    push    bp
    mov     bp, sp
    sub     sp, 0x12
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x4c
    imul    word ptr [bp+param_2]
    add     ax, 0x81fc
    mov     word ptr [bp+var_8], ax
    mov     bx, ax
    mov     ax, word ptr [bx+0x1e]
    mov     dx, word ptr [bx+0x20]
    mov     word ptr [bp+var_4], ax
    mov     word ptr [bp+var_4+2], dx
    les     bx, [bp+var_4]
    cmp     byte ptr es:[bx+0x5], 0x5
    jz      LAB_3863_07ea
    jmp     near ptr LAB_3863_086e
LAB_3863_07ea:
    mov     bx, word ptr [bp+param_1]
    mov     al, byte ptr [bx+0x4]
    sub     ah, ah
    sub     ax, 0x18
    cmp     ax, 0xf
    ja      LAB_3863_0844
    add     ax, ax
    xchg    ax, bx
switchD:
    jmp     word ptr cs:[bx+0x84e]
LAB_3863_0802:
    mov     ax, word ptr [basdres]
    mov     dx, word ptr [basdres+2]
LAB_3863_0809:
    mov     word ptr [bp+var_4], ax
    mov     word ptr [bp+var_4+2], dx
    jmp     LAB_3863_086e
    db 0x90
LAB_3863_0812:
    mov     ax, word ptr [snarres]
    mov     dx, word ptr [snarres+2]
    jmp     LAB_3863_0809
    db 0x90
LAB_3863_081c:
    mov     ax, word ptr [rideres]
    mov     dx, word ptr [rideres+2]
    jmp     LAB_3863_0809
    db 0x90
LAB_3863_0826:
    mov     ax, word ptr [crshres]
    mov     dx, word ptr [crshres+2]
    jmp     LAB_3863_0809
    db 0x90
LAB_3863_0830:
    mov     ax, word ptr [chhtres]
    mov     dx, word ptr [chhtres+2]
    jmp     LAB_3863_0809
    db 0x90
LAB_3863_083a:
    mov     ax, word ptr [ohhtres]
    mov     dx, word ptr [ohhtres+2]
    jmp     LAB_3863_0809
    db 0x90
LAB_3863_0844:
    mov     ax, word ptr [tommres]
    mov     dx, word ptr [tommres+2]
    jmp     LAB_3863_0809
    db 0x90
    dw LAB_3863_0802
    dw LAB_3863_0844
    dw LAB_3863_0812
    dw LAB_3863_0844
    dw LAB_3863_0844
    dw LAB_3863_0844
    dw LAB_3863_0830
    dw LAB_3863_0844
    dw LAB_3863_083a
    dw LAB_3863_0844
    dw LAB_3863_083a
    dw LAB_3863_0844
    dw LAB_3863_0844
    dw LAB_3863_081c
    dw LAB_3863_0844
    dw LAB_3863_0826
LAB_3863_086e:
    mov     ax, word ptr [bp+var_4]
    or      ax, word ptr [bp+var_4+2]
    jnz     LAB_3863_0880
LAB_3863_0876:
    mov     ax, 0xffff
    pop     ds
    pop     si
    mov     sp, bp
    pop     bp
    retf
    db 0x90
LAB_3863_0880:
    push    word ptr [bp+var_8]
    push    word ptr [bp+var_4+2]
    push    word ptr [bp+var_4]
    push    cs
    call    near ptr sub_390C8
    add     sp, 0x6
    mov     word ptr [bp+var_6], ax
    cmp     ax, 0xffff
    jz      LAB_3863_0876
    mov     ax, 0x2e
    imul    word ptr [bp+var_6]
    add     ax, 0xa2b6
    mov     word ptr [bp+var_A], ax
    mov     bx, ax
    mov     ax, word ptr [bp+var_4]
    mov     dx, word ptr [bp+var_4+2]
    cmp     word ptr [bx+0x10], ax
    jnz     LAB_3863_08b6
    cmp     word ptr [bx+0x12], dx
    jz      LAB_3863_08e8
LAB_3863_08b6:
    mov     ax, word ptr [bp+var_4]
    mov     dx, word ptr [bp+var_4+2]
    mov     word ptr [bx+0x10], ax
    mov     word ptr [bx+0x12], dx
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_08e8
    push    dx
    push    ax
    push    word ptr [bp+var_8]
    push    bx
    push    word ptr [bp+var_6]
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x21
    mov     word ptr [bp+var_E+2], dx
    mov     word ptr [bp+var_E], ax
    call    dword ptr [bp+var_E]
    add     sp, 0xa
LAB_3863_08e8:
    mov     bx, word ptr [bp+var_A]
    mov     al, byte ptr [bp+param_2]
    mov     byte ptr [bx], al
    mov     ax, word ptr [bp+var_8]
    mov     word ptr [bx+0x2a], ax
    mov     byte ptr [bx+0x1], 0x1
    mov     byte ptr [bx+0x16], 0x1
    mov     si, bx
    les     si, [si+0x10]
    mov     ax, word ptr es:[si+0x1c]
    mov     word ptr [bx+0x14], ax
    mov     si, word ptr [bp+var_8]
    mov     al, byte ptr [si+0x24]
    mov     byte ptr [bx+0x2], al
    sub     ax, ax
    mov     word ptr [bx+0xa], ax
    mov     word ptr [bx+0x8], ax
    mov     si, word ptr [bp+param_1]
    mov     ax, word ptr [si+0x6]
    mov     dx, word ptr [si+0x8]
    sub     ax, 0x1
    sbb     dx, 0x0
    mov     word ptr [bx+0xc], ax
    mov     word ptr [bx+0xe], dx
    les     si, [bp+var_4]
    mov     ax, word ptr es:[si+0x2a]
    mov     word ptr [bx+0x18], ax
    mov     ax, word ptr es:[si+0x2c]
    mov     word ptr [bx+0x1a], ax
    mov     ax, word ptr es:[si+0x30]
    mov     word ptr [bx+0x24], ax
    mov     word ptr [bx+0x1c], 0x0
    mov     al, byte ptr es:[si+0x34]
    mov     byte ptr [bx+0x26], al
    mov     byte ptr [bx+0x27], 0x0
    mov     ax, word ptr es:[si+0x36]
    mov     word ptr [bx+0x1e], ax
    mov     ax, word ptr es:[si+0x38]
    mov     word ptr [bx+0x20], ax
    mov     byte ptr [bx+0x28], 0x0
    mov     byte ptr [bx+0x22], 0x0
    mov     byte ptr [bx+0x29], 0x0
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_097e
    mov     al, byte ptr [bp+var_6]
    jmp     LAB_3863_0984
LAB_3863_097e:
    mov     si, word ptr [bp+var_8]
    mov     al, byte ptr [si+0x47]
LAB_3863_0984:
    mov     byte ptr [bx+0x2c], al
    mov     bx, word ptr [bp+param_1]
    cmp     byte ptr [bx+0x4], 0xff
    jnz     LAB_3863_09c2
    push    word ptr [bx]
    push    word ptr [bp+var_A]
    mov     bx, word ptr [bp+var_A]
    mov     al, byte ptr [bx+0x2c]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x24
    mov     word ptr [bp+var_E+2], dx
    mov     word ptr [bp+var_E], ax
    call    dword ptr [bp+var_E]
    add     sp, 0x6
    cmp     byte ptr [byte_40634], 0x0
    jz      LAB_3863_09c2
    mov     bx, word ptr [bp+param_1]
    mov     byte ptr [bx+0x4], 0x3c
LAB_3863_09c2:
    push    word ptr [bp+var_4+2]
    push    word ptr [bp+var_4]
    mov     bx, word ptr [bp+param_1]
    mov     al, byte ptr [bx+0x5]
    sub     ah, ah
    push    ax
    les     bx, [bp+var_4]
    mov     al, byte ptr es:[bx+0x10]
    cbw
    mov     bx, word ptr [bp+param_1]
    mov     cx, ax
    mov     al, byte ptr [bx+0x4]
    cbw
    add     ax, cx
    push    ax
    push    word ptr [bp+var_8]
    push    word ptr [bp+var_A]
    mov     bx, word ptr [bp+var_A]
    mov     al, byte ptr [bx+0x2c]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x9
    mov     word ptr [bp+var_12+2], dx
    mov     word ptr [bp+var_12], ax
    call    dword ptr [bp+var_12]
    add     sp, 0xe
    mov     bx, word ptr [bp+param_2]
    mov     si, word ptr [bp+param_1]
    mov     al, byte ptr [si+0x4]
    mov     byte ptr [bx+byte_44ACA], al
    mov     ax, word ptr [bp+var_6]
    pop     ds
    pop     si
    mov     sp, bp
    pop     bp
    retf
audio_drum_unk_asm_ endp

; undefined __cdecl16far audio_drum_unk2(word param_1, word param_2)
audio_drum_unk2_asm_ proc far
    param_1    = word ptr    6
    param_2    = word ptr    8

    push    bp
    mov     bp, sp
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     byte ptr [byte_42A0E], 0xff
    mov     ax, word ptr [bp+param_1]
    mov     word ptr [word_42A0A], ax
    mov     word ptr [word_42A0C], 0x0
    mov     word ptr [word_42A10], 0xffe0
    mov     word ptr [word_42A12], 0xffff
    push    word ptr [bp+param_2]
    mov     ax, offset word_42A0A
    push    ax
    push    cs
    call    near ptr audio_drum_unk
    add     sp, 0x4
    pop     ds
    pop     bp
    retf
audio_drum_unk2_asm_ endp
    db 0x90

; undefined __cdecl16far sub_39088(void)
sub_39088_asm_ proc far
    var_4      = dword ptr  -4

    push    bp
    mov     bp, sp
    sub     sp, 0x4
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, 0x2e
    imul    word ptr [bp+0x6]
    mov     si, ax
    push    word ptr [bp+0x8]
    add     ax, 0xa2b6
    push    ax
    mov     al, byte ptr [si+0xa2e2]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x24
    mov     word ptr [bp+var_4+2], dx
    mov     word ptr [bp+var_4], ax
    call    dword ptr [bp+var_4]
    add     sp, 0x6
    pop     ds
    pop     si
    mov     sp, bp
    pop     bp
    retf
sub_39088_asm_ endp
    db 0x90

; uint * __cdecl16far sub_390C8(undefined4 param_1, int param_2)
sub_390C8_asm_ proc far
    local_1c   = word ptr  -26
    local_1a   = word ptr  -24
    local_18   = word ptr  -22
    local_16   = word ptr  -20
    local_14   = word ptr  -18
    local_12   = word ptr  -16
    local_10   = word ptr  -14
    local_e    = word ptr  -12
    local_c    = word ptr  -10
    local_a    = word ptr   -8
    local_8    = word ptr   -6
    local_6    = word ptr   -4
    local_4    = word ptr   -2
    param_1    = dword ptr   6
    param_2    = word ptr   10

    push    bp
    mov     bp, sp
    sub     sp, 0x1a
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     word ptr [bp+local_12], 0xffff
    mov     word ptr [bp+local_10], 0xffff
    sub     ax, ax
    mov     word ptr [bp+local_a], ax
    mov     word ptr [bp+local_c], ax
    mov     word ptr [bp+local_4], ax
    mov     word ptr [bp+local_6], ax
    les     bx, [bp+param_1]
    cmp     word ptr es:[bx+0xc], ax
    jnz     LAB_3863_0ace
LAB_3863_0ac7:
    mov     ax, 0xffff
    jmp     near ptr LAB_3863_0e22
    db 0x90
LAB_3863_0ace:
    cmp     byte ptr [byte_40634], 0x0
    jnz     LAB_3863_0ad8
    jmp     near ptr LAB_3863_0bc0
LAB_3863_0ad8:
    sub     si, si
    mov     di, 0xa2b6
LAB_3863_0add:
    mov     cx, di
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x0
    jnz     LAB_3863_0af2
LAB_3863_0ae7:
    mov     ax, si
    mov     word ptr [bp+local_8], si
    mov     word ptr [bp+local_e], cx
    jmp     near ptr LAB_3863_0e22
LAB_3863_0af2:
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x1
    jnz     LAB_3863_0b1d
    mov     ax, word ptr [bp+local_c]
    mov     dx, word ptr [bp+local_a]
    cmp     word ptr [bx+0xa], dx
    jc      LAB_3863_0b1d
    ja      LAB_3863_0b0c
    cmp     word ptr [bx+0x8], ax
    jbe     LAB_3863_0b1d
LAB_3863_0b0c:
    mov     bx, cx
    mov     ax, word ptr [bx+0x8]
    mov     dx, word ptr [bx+0xa]
    mov     word ptr [bp+local_c], ax
    mov     word ptr [bp+local_a], dx
    mov     word ptr [bp+local_12], si
LAB_3863_0b1d:
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x2
    jnz     LAB_3863_0b48
    mov     ax, word ptr [bp+local_6]
    mov     dx, word ptr [bp+local_4]
    cmp     word ptr [bx+0xa], dx
    jc      LAB_3863_0b48
    ja      LAB_3863_0b37
    cmp     word ptr [bx+0x8], ax
    jbe     LAB_3863_0b48
LAB_3863_0b37:
    mov     bx, cx
    mov     ax, word ptr [bx+0x8]
    mov     dx, word ptr [bx+0xa]
    mov     word ptr [bp+local_6], ax
    mov     word ptr [bp+local_4], dx
    mov     word ptr [bp+local_10], si
LAB_3863_0b48:
    add     di, 0x2e
    inc     si
    cmp     si, 0x10
    jl      LAB_3863_0add
    mov     word ptr [bp+local_8], si
    mov     word ptr [bp+local_e], cx
    cmp     word ptr [bp+local_10], -0x1
    jz      LAB_3863_0b64
LAB_3863_0b5d:
    mov     ax, word ptr [bp+local_10]
    jmp     near ptr LAB_3863_0e22
    db 0x90
LAB_3863_0b64:
    cmp     word ptr [bp+local_12], -0x1
    jnz     LAB_3863_0b6d
    jmp     near ptr LAB_3863_0ac7
LAB_3863_0b6d:
    mov     ax, 0x2e
    imul    word ptr [bp+local_12]
    mov     si, ax
    add     ax, 0xa2b6
    push    ax
    mov     al, byte ptr [si+0xa2e2]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xc
    mov     word ptr [bp+local_16], dx
    mov     word ptr [bp+local_18], ax
    call    dword ptr [bp+local_18]
    add     sp, 0x4
    mov     ax, si
    add     ax, 0xa2b6
    push    ax
    mov     al, byte ptr [si+0xa2e2]
    sub     ah, ah
    push    ax
LAB_3863_0ba3:
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xf
    mov     word ptr [bp+local_16], dx
    mov     word ptr [bp+local_18], ax
    call    dword ptr [bp+local_18]
    add     sp, 0x4
    mov     ax, word ptr [bp+local_12]
    jmp     near ptr LAB_3863_0e22
    db 0x90
LAB_3863_0bc0:
    mov     bx, word ptr [bp+param_2]
    mov     si, bx
    mov     al, byte ptr [si+0x16]
    cmp     byte ptr [bx+0x15], al
    jnc     LAB_3863_0bd0
    jmp     near ptr LAB_3863_0d14
LAB_3863_0bd0:
    mov     word ptr [bp+local_8], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jnz     LAB_3863_0be1
    jmp     near ptr LAB_3863_0c95
LAB_3863_0be1:
    mov     word ptr [bp+local_14], ax
    mov     word ptr [bp+local_1a], 0x4e9e
    mov     word ptr [bp+local_1c], 0xa2b6
    mov     di, word ptr [bp+local_8]
    mov     si, word ptr [bp+local_e]
    mov     cx, bx
LAB_3863_0bf6:
    mov     bx, word ptr [bp+local_1a]
    mov     ax, word ptr [bx]
    les     bx, [bp+param_1]
    test    word ptr es:[bx+0xc], ax
    jz      LAB_3863_0c7c
    mov     si, word ptr [bp+local_1c]
    mov     bx, cx
    mov     al, byte ptr [si]
    cmp     byte ptr [bx+0x23], al
    jnz     LAB_3863_0c7c
    cmp     byte ptr [si+0x1], 0x0
    jnz     LAB_3863_0c24
    inc     byte ptr [bx+0x15]
    mov     ax, di
    mov     word ptr [bp+local_8], di
    mov     word ptr [bp+local_e], si
    jmp     near ptr LAB_3863_0e22
LAB_3863_0c24:
    mov     bx, cx
    mov     al, byte ptr [si+0x2]
    cmp     byte ptr [bx+0x24], al
    jc      LAB_3863_0c7c
    cmp     byte ptr [si+0x1], 0x1
    jnz     LAB_3863_0c55
    mov     ax, word ptr [bp+local_c]
    mov     dx, word ptr [bp+local_a]
    cmp     word ptr [si+0xa], dx
    jc      LAB_3863_0c55
    ja      LAB_3863_0c46
    cmp     word ptr [si+0x8], ax
    jbe     LAB_3863_0c55
LAB_3863_0c46:
    mov     ax, word ptr [si+0x8]
    mov     dx, word ptr [si+0xa]
    mov     word ptr [bp+local_c], ax
    mov     word ptr [bp+local_a], dx
    mov     word ptr [bp+local_12], di
LAB_3863_0c55:
    cmp     byte ptr [si+0x1], 0x2
    jnz     LAB_3863_0c7c
    mov     ax, word ptr [bp+local_6]
    mov     dx, word ptr [bp+local_4]
    cmp     word ptr [si+0xa], dx
    jc      LAB_3863_0c7c
    ja      LAB_3863_0c6d
    cmp     word ptr [si+0x8], ax
    jbe     LAB_3863_0c7c
LAB_3863_0c6d:
    mov     ax, word ptr [si+0x8]
    mov     dx, word ptr [si+0xa]
    mov     word ptr [bp+local_6], ax
    mov     word ptr [bp+local_4], dx
    mov     word ptr [bp+local_10], di
LAB_3863_0c7c:
    add     word ptr [bp+local_1a], 0x2
    add     word ptr [bp+local_1c], 0x2e
    inc     di
    mov     ax, di
    cmp     ax, word ptr [bp+local_14]
    jnc     LAB_3863_0c8f
    jmp     near ptr LAB_3863_0bf6
LAB_3863_0c8f:
    mov     word ptr [bp+local_8], di
    mov     word ptr [bp+local_e], si
LAB_3863_0c95:
    cmp     word ptr [bp+local_10], -0x1
    jz      BYTE_ARRAY_3863_0cde
LAB_3863_0c9b:
    mov     ax, 0x2e
    imul    word ptr [bp+local_10]
    mov     si, ax
    add     si, 0xa2b6
    push    si
    push    word ptr [bp+local_10]
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xc
    mov     word ptr [bp+local_16], dx
    mov     word ptr [bp+local_18], ax
    call    dword ptr [bp+local_18]
    add     sp, 0x4
    push    si
    push    word ptr [bp+local_10]
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xf
    mov     word ptr [bp+local_16], dx
    mov     word ptr [bp+local_18], ax
    call    dword ptr [bp+local_18]
    add     sp, 0x4
    jmp     near ptr LAB_3863_0b5d
BYTE_ARRAY_3863_0cde:
    db 0x83, 0x7E
    db 0xF0
    push    word ptr [di+0x3]
    jmp     near ptr LAB_3863_0ac7
LAB_3863_0ce7:
    mov     ax, 0x2e
    imul    word ptr [bp+local_12]
    mov     si, ax
    add     si, 0xa2b6
    push    si
    push    word ptr [bp+local_12]
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xc
    mov     word ptr [bp+local_16], dx
    mov     word ptr [bp+local_18], ax
    call    dword ptr [bp+local_18]
    add     sp, 0x4
    push    si
    push    word ptr [bp+local_12]
    jmp     near ptr LAB_3863_0ba3
LAB_3863_0d14:
    mov     word ptr [bp+local_8], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jnz     LAB_3863_0d25
    jmp     near ptr LAB_3863_0dd1
LAB_3863_0d25:
    mov     word ptr [bp+local_1c], ax
    mov     di, 0xa2b6
    mov     word ptr [bp+local_14], 0x4e9e
    mov     si, word ptr [bp+local_8]
LAB_3863_0d33:
    mov     cx, di
    mov     bx, word ptr [bp+local_14]
    mov     ax, word ptr [bx]
    les     bx, [bp+param_1]
    test    word ptr es:[bx+0xc], ax
    jz      LAB_3863_0db9
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x0
    jnz     LAB_3863_0d56
    mov     bx, word ptr [bp+param_2]
    inc     byte ptr [bx+0x15]
    jmp     near ptr LAB_3863_0ae7
    db 2 dup (0x90)
LAB_3863_0d56:
    mov     bx, cx
    mov     al, byte ptr [bx+0x2]
    mov     bx, word ptr [bp+param_2]
    cmp     byte ptr [bx+0x24], al
    jc      LAB_3863_0db9
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x1
    jnz     LAB_3863_0d8e
    mov     ax, word ptr [bp+local_c]
    mov     dx, word ptr [bp+local_a]
    cmp     word ptr [bx+0xa], dx
    jc      LAB_3863_0d8e
    ja      LAB_3863_0d7d
    cmp     word ptr [bx+0x8], ax
    jbe     LAB_3863_0d8e
LAB_3863_0d7d:
    mov     bx, cx
    mov     ax, word ptr [bx+0x8]
    mov     dx, word ptr [bx+0xa]
    mov     word ptr [bp+local_c], ax
    mov     word ptr [bp+local_a], dx
    mov     word ptr [bp+local_12], si
LAB_3863_0d8e:
    mov     bx, cx
    cmp     byte ptr [bx+0x1], 0x2
    jnz     LAB_3863_0db9
    mov     ax, word ptr [bp+local_6]
    mov     dx, word ptr [bp+local_4]
    cmp     word ptr [bx+0xa], dx
    jc      LAB_3863_0db9
    ja      LAB_3863_0da8
    cmp     word ptr [bx+0x8], ax
    jbe     LAB_3863_0db9
LAB_3863_0da8:
    mov     bx, cx
    mov     ax, word ptr [bx+0x8]
    mov     dx, word ptr [bx+0xa]
    mov     word ptr [bp+local_6], ax
    mov     word ptr [bp+local_4], dx
    mov     word ptr [bp+local_10], si
LAB_3863_0db9:
    add     di, 0x2e
    add     word ptr [bp+local_14], 0x2
    inc     si
    mov     ax, si
    cmp     ax, word ptr [bp+local_1c]
    jnc     LAB_3863_0dcb
    jmp     near ptr LAB_3863_0d33
LAB_3863_0dcb:
    mov     word ptr [bp+local_8], si
    mov     word ptr [bp+local_e], cx
LAB_3863_0dd1:
    cmp     word ptr [bp+local_10], -0x1
    jz      LAB_3863_0df8
    mov     ax, 0x2e
    imul    word ptr [bp+local_10]
    mov     bx, ax
    mov     si, word ptr [bx+0xa2e0]
    cmp     word ptr [bp+param_2], si
    jnz     LAB_3863_0deb
    jmp     near ptr LAB_3863_0c9b
LAB_3863_0deb:
    dec     byte ptr [si+0x15]
    mov     bx, word ptr [bp+param_2]
    inc     byte ptr [bx+0x15]
    jmp     near ptr LAB_3863_0c9b
    db 0x90
LAB_3863_0df8:
    cmp     word ptr [bp+local_12], -0x1
    jnz     LAB_3863_0e01
    jmp     near ptr LAB_3863_0ac7
LAB_3863_0e01:
    mov     ax, 0x2e
    imul    word ptr [bp+local_12]
    mov     bx, ax
    mov     si, word ptr [bx+0xa2e0]
    cmp     word ptr [bp+param_2], si
    jnz     LAB_3863_0e15
    jmp     near ptr LAB_3863_0ce7
LAB_3863_0e15:
    dec     byte ptr [si+0x15]
    mov     bx, word ptr [bp+param_2]
    inc     byte ptr [bx+0x15]
    jmp     near ptr LAB_3863_0ce7
    db 0x90
LAB_3863_0e22:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_390C8_asm_ endp
    db 0x90

; undefined __cdecl16far sub_3945A(word param_1, void * param_2)
sub_3945A_asm_ proc far
    var_C      = word ptr  -12
    var_A      = word ptr  -10
    var_8      = byte ptr   -8
    var_6      = word ptr   -6
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    param_1    = word ptr    6
    param_2    = dword ptr   8

    push    bp
    mov     bp, sp
    sub     sp, 0xc
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     ax, word ptr [bp+param_2]
    mov     dx, word ptr [bp+param_2+2]
    mov     word ptr [bp+var_6], ax
    mov     word ptr [bp+var_4], dx
    mov     bx, word ptr [bp+param_1]
    sub     ax, ax
    mov     word ptr [bx+0x2], ax
    mov     word ptr [bx], ax
    mov     si, bx
LAB_3863_0e50:
    les     bx, [bp+param_2]
    mov     al, byte ptr es:[bx]
    sub     ah, ah
    and     ax, 0x7f
    sub     dx, dx
    mov     cx, word ptr [si]
    mov     bx, word ptr [si+0x2]
    mov     di, cx
    mov     cl, 0x7
LAB_3863_0e66:
    shl     di, 0x1
    rcl     bx, 0x1
    dec     cl
    jnz     LAB_3863_0e66
    add     ax, di
    adc     dx, bx
    mov     word ptr [si], ax
    mov     word ptr [si+0x2], dx
    les     bx, [bp+param_2]
    inc     word ptr [bp+param_2]
    test    byte ptr es:[bx], 0x80
    jnz     LAB_3863_0e50
    mov     bx, word ptr [bp+param_1]
    mov     si, word ptr [bp+param_2]
    inc     word ptr [bp+param_2]
    mov     al, byte ptr es:[si]
    mov     byte ptr [bx+0x4], al
    mov     byte ptr [bp+var_8], al
    sub     ah, ah
    sub     ax, 0xd9
    cmp     ax, 0x11
    jbe     LAB_3863_0ea2
    jmp     near ptr LAB_3863_0f9c
LAB_3863_0ea2:
    add     ax, ax
    xchg    ax, bx
switchD_:
    jmp     word ptr cs:[bx+0xf78]
LAB_3863_0eaa:
    mov     word ptr [bp-0x2], 0x0
    mov     bx, word ptr [bp+0x8]
    mov     al, byte ptr es:[bx]
    sub     ah, ah
    or      ax, ax
    jz      LAB_3863_0ee8
    mov     word ptr [bp-0xa], ax
    mov     word ptr [bp-0xc], ax
    mov     bx, word ptr [bp-0x2]
    mov     ax, bx
    add     ax, word ptr [bp+0x8]
    mov     dx, es
    inc     ax
    mov     cx, word ptr [bp-0xc]
    shr     cx, 0x1
    lea     di, [bx+0x717e]
    mov     si, ax
    push    ds
    pop     es
    push    ds
    mov     ds, dx
    rep movsw
    jnc     LAB_3863_0ee1
    movsb
LAB_3863_0ee1:
    pop     ds
    mov     ax, word ptr [bp-0xc]
    add     word ptr [bp-0x2], ax
LAB_3863_0ee8:
    les     bx, [bp+0x8]
    mov     al, byte ptr es:[bx]
    sub     ah, ah
    add     word ptr [bp+0x8], ax
    inc     word ptr [bp+0x8]
    jmp     near ptr LAB_3863_0f9c
    db 0x90
LAB_3863_0efa:
    mov     bx, word ptr [bp+0x6]
    mov     si, word ptr [bp+0x8]
    inc     word ptr [bp+0x8]
    mov     al, byte ptr es:[si]
    mov     byte ptr [bx+0x5], al
    push    es
    push    word ptr [bp+0x8]
    call    far ptr audioresource_get_dword
    add     sp, 0x4
    mov     bx, word ptr [bp+0x6]
    mov     word ptr [bx+0x6], ax
    mov     word ptr [bx+0x8], dx
    add     word ptr [bp+0x8], 0x4
    jmp     LAB_3863_0f9c
LAB_3863_0f24:
    mov     bx, word ptr [bp+0x6]
    les     si, [bp+0x8]
    inc     word ptr [bp+0x8]
    mov     al, byte ptr es:[si]
    mov     byte ptr [bx+0x5], al
    jmp     LAB_3863_0f9c
    db 0x90
LAB_3863_0f36:
    mov     bx, word ptr [bp+0x6]
    mov     si, word ptr [bp+0x8]
    inc     word ptr [bp+0x8]
    mov     al, byte ptr es:[si]
    mov     byte ptr [bx+0x5], al
    mov     si, word ptr [bp+0x8]
    inc     word ptr [bp+0x8]
    mov     al, byte ptr es:[si]
    sub     ah, ah
    mov     word ptr [bx+0x6], ax
    mov     word ptr [bx+0x8], 0x0
    jmp     LAB_3863_0f9c
LAB_3863_0f5a:
    push    es
    push    word ptr [bp+0x8]
    call    far ptr audioresource_get_word
    add     sp, 0x4
    mov     bx, word ptr [bp+0x6]
    mov     word ptr [bx+0x6], ax
    mov     word ptr [bx+0x8], 0x0
    add     word ptr [bp+0x8], 0x2
    jmp     LAB_3863_0f9c
    db 0x90
    dw LAB_3863_0f9c
    dw LAB_3863_0f9c
    dw LAB_3863_0f9c
    dw LAB_3863_0f24
    dw LAB_3863_0f24
    dw LAB_3863_0f24
    dw LAB_3863_0f36
    dw LAB_3863_0f24
    dw LAB_3863_0f24
    dw LAB_3863_0f24
    dw LAB_3863_0f9c
    dw LAB_3863_0f24
    dw LAB_3863_0f5a
    dw LAB_3863_0efa
    dw LAB_3863_0ee8
    dw LAB_3863_0eaa
    dw LAB_3863_0f24
    dw LAB_3863_0f24
LAB_3863_0f9c:
    cmp     byte ptr [bp+var_8], 0xd9
    jnc     LAB_3863_0ff9
    cmp     byte ptr [bp+var_8], 0x80
    jbe     LAB_3863_0fb7
    mov     bx, word ptr [bp+param_1]
    les     si, [bp+param_2]
    inc     word ptr [bp+param_2]
    mov     al, byte ptr es:[si]
    mov     byte ptr [bx+0x5], al
LAB_3863_0fb7:
    mov     bx, word ptr [bp+param_1]
    sub     ax, ax
    mov     word ptr [bx+0x8], ax
    mov     word ptr [bx+0x6], ax
    mov     si, bx
LAB_3863_0fc4:
    les     bx, [bp+param_2]
    mov     al, byte ptr es:[bx]
    sub     ah, ah
    and     ax, 0x7f
    sub     dx, dx
    mov     cx, word ptr [si+0x6]
    mov     bx, word ptr [si+0x8]
    mov     di, cx
    mov     cl, 0x7
LAB_3863_0fdb:
    shl     di, 0x1
    rcl     bx, 0x1
    dec     cl
    jnz     LAB_3863_0fdb
    add     ax, di
    adc     dx, bx
    mov     word ptr [si+0x6], ax
    mov     word ptr [si+0x8], dx
    les     bx, [bp+param_2]
    inc     word ptr [bp+param_2]
    test    byte ptr es:[bx], 0x80
    jnz     LAB_3863_0fc4
LAB_3863_0ff9:
    mov     bx, word ptr [bp+param_1]
    mov     ax, word ptr [bp+param_2]
    sub     ax, word ptr [bp+var_6]
    mov     byte ptr [bx+0xa], al
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_3945A_asm_ endp

; undefined __cdecl16far sub_3963C(void)
sub_3963C_asm_ proc far
    var_4      = word ptr   -4
    var_2      = word ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0x6
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     word ptr [bp+var_2], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jz      LAB_3863_1053
    mov     di, 0xa2b6
LAB_3863_102b:
    mov     si, di
    cmp     byte ptr [si+0x1], 0x0
    jz      LAB_3863_1040
    cmp     byte ptr [si], 0x10
    jnc     LAB_3863_1040
    push    si
    push    cs
    call    near ptr sub_3968A
    add     sp, 0x2
LAB_3863_1040:
    add     di, 0x2e
    inc     word ptr [bp+var_2]
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    cmp     word ptr [bp+var_2], ax
    jc      LAB_3863_102b
    mov     word ptr [bp+var_4], si
LAB_3863_1053:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
sub_3963C_asm_ endp

; undefined __cdecl16far sub_3968A(byte * param_1)
sub_3968A_asm_ proc far
    var_4      = dword ptr  -4
    param_1    = word ptr    6

    push    bp
    mov     bp, sp
    sub     sp, 0x4
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     bx, word ptr [bp+param_1]
    add     word ptr [bx+0x8], 0x1
    adc     word ptr [bx+0xa], 0x0
    mov     ax, word ptr [bx+0xc]
    or      ax, word ptr [bx+0xe]
    jnz     LAB_3863_10c2
    push    bx
    mov     al, byte ptr [bx+0x2c]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xc
    mov     word ptr [bp+var_4+2], dx
    mov     word ptr [bp+var_4], ax
    call    dword ptr [bp+var_4]
    add     sp, 0x4
    mov     bx, word ptr [bp+param_1]
    mov     byte ptr [bx+0x1], 0x2
    mov     al, 0x4c
    mul     byte ptr [bx]
    mov     bx, ax
    cmp     byte ptr [bx+(audiochunks_unk+37)], 0x0
    jz      LAB_3863_10b6
    mov     bx, word ptr [bp+param_1]
    mov     byte ptr [bx+0x16], 0x3
    pop     ds
    mov     sp, bp
    pop     bp
    retf
LAB_3863_10b6:
    mov     bx, word ptr [bp+param_1]
    mov     byte ptr [bx+0x16], 0x4
    pop     ds
    mov     sp, bp
    pop     bp
    retf
LAB_3863_10c2:
    sub     word ptr [bx+0xc], 0x1
    sbb     word ptr [bx+0xe], 0x0
    pop     ds
    mov     sp, bp
    pop     bp
    retf
sub_3968A_asm_ endp
    db 0x90

; undefined __cdecl16far sub_39700(void)
sub_39700_asm_ proc far
    var_C      = dword ptr -12
    var_8      = word ptr   -8
    var_6      = dword ptr  -6
    var_2      = word ptr   -2

    push    bp
    mov     bp, sp
    sub     sp, 0xc
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    mov     word ptr [bp+var_2], 0x0
    jmp     near ptr LAB_3863_12a0
    db 0x90
LAB_3863_10e6:
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx+0x16], 0x2
LAB_3863_10ed:
    cmp     byte ptr [bx+0x16], 0x2
    jnz     LAB_3863_110d
    les     si, [bp+var_6]
    mov     ax, word ptr es:[si+0x22]
    sub     word ptr [bx+0x14], ax
    mov     ax, word ptr es:[si+0x24]
    cmp     word ptr [bx+0x14], ax
    jg      LAB_3863_110d
    mov     byte ptr [bx+0x16], 0x3
    mov     word ptr [bx+0x14], ax
LAB_3863_110d:
    cmp     byte ptr [bx+0x16], 0x3
    jnz     LAB_3863_1124
    les     bx, [bp+var_6]
    cmp     word ptr es:[bx+0x24], 0x0
    jnz     LAB_3863_1124
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx+0x16], 0x4
LAB_3863_1124:
    mov     bx, word ptr [bp+var_8]
    cmp     byte ptr [bx+0x16], 0x4
    jnz     LAB_3863_1181
    les     si, [bp+var_6]
    mov     ax, word ptr es:[si+0x26]
    sub     word ptr [bx+0x14], ax
    cmp     word ptr [bx+0x14], 0x0
    jg      LAB_3863_1181
    mov     word ptr [bx+0x14], 0x0
    mov     byte ptr [bx+0x16], 0x0
    mov     byte ptr [bx+0x1], 0x0
    mov     al, 0x4c
    mul     byte ptr [bx]
    mov     bx, ax
    dec     byte ptr [bx+(audiochunks_unk+21)]
    push    word ptr [bp+var_8]
    mov     bx, word ptr [bp+var_8]
    mov     al, byte ptr [bx+0x2c]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0xf
    mov     word ptr [bp+var_C+2], dx
    mov     word ptr [bp+var_C], ax
    call    dword ptr [bp+var_C]
    add     sp, 0x4
    mov     bx, word ptr [bp+var_8]
    mov     bl, byte ptr [bx]
    sub     bh, bh
    mov     byte ptr [bx+byte_44ACA], bh
LAB_3863_1181:
    les     bx, [bp+var_6]
    cmp     byte ptr es:[bx+0x28], 0x0
    jnz     LAB_3863_118e
    jmp     near ptr LAB_3863_1223
LAB_3863_118e:
    mov     bx, word ptr [bp+var_8]
    cmp     word ptr [bx+0x18], 0x0
    jz      LAB_3863_119e
    dec     word ptr [bx+0x18]
    jmp     near ptr LAB_3863_1223
    db 0x90
LAB_3863_119e:
    cmp     word ptr [bx+0x1a], 0x0
    jz      LAB_3863_1223
    cmp     word ptr [bx+0x1a], 0x7fff
    jz      LAB_3863_11ae
    dec     word ptr [bx+0x1a]
LAB_3863_11ae:
    cmp     byte ptr [bx+0x27], 0x0
    jnz     LAB_3863_1220
    les     si, [bp+var_6]
    mov     al, byte ptr es:[si+0x29]
    mov     byte ptr [bx+0x27], al
    cmp     byte ptr [bx+0x26], 0x2
    jnz     LAB_3863_11f8
    mov     si, bx
    mov     ax, word ptr [si+0x24]
    sub     word ptr [bx+0x1c], ax
    mov     ax, word ptr [bx+0x1c]
    cwd
    xor     ax, dx
    sub     ax, dx
    mov     bx, word ptr [bp+var_6]
    cmp     word ptr es:[bx+0x2e], ax
    ja      LAB_3863_1223
    test    byte ptr es:[bx+0x34], 0x1
    jz      LAB_3863_11ee
    mov     bx, si
    mov     byte ptr [bx+0x26], 0x1
    jmp     LAB_3863_1223
    db 2 dup (0x90)
LAB_3863_11ee:
    mov     bx, word ptr [bp+var_8]
    mov     word ptr [bx+0x1c], 0x0
    jmp     LAB_3863_1223
LAB_3863_11f8:
    mov     si, bx
    mov     ax, word ptr [si+0x24]
    add     word ptr [bx+0x1c], ax
    mov     ax, word ptr [bx+0x1c]
    cwd
    xor     ax, dx
    sub     ax, dx
    mov     bx, word ptr [bp+var_6]
    cmp     word ptr es:[bx+0x2e], ax
    ja      LAB_3863_1223
    test    byte ptr es:[bx+0x34], 0x2
    jz      LAB_3863_11ee
    mov     bx, si
    mov     byte ptr [bx+0x26], 0x2
    jmp     LAB_3863_1223
LAB_3863_1220:
    dec     byte ptr [bx+0x27]
LAB_3863_1223:
    les     bx, [bp+var_6]
    cmp     byte ptr es:[bx+0x35], 0x0
    jz      LAB_3863_1274
    mov     bx, word ptr [bp+var_8]
    cmp     word ptr [bx+0x1e], 0x0
    jz      LAB_3863_123c
    dec     word ptr [bx+0x1e]
    jmp     LAB_3863_1274
    db 0x90
LAB_3863_123c:
    cmp     word ptr [bx+0x20], 0x0
    jz      LAB_3863_1274
    dec     word ptr [bx+0x20]
    cmp     byte ptr [bx+0x28], 0x0
    jz      LAB_3863_1250
    dec     byte ptr [bx+0x28]
    jmp     LAB_3863_1274
LAB_3863_1250:
    les     si, [bp+var_6]
    mov     al, byte ptr es:[si+0x3a]
    mov     byte ptr [bx+0x28], al
    mov     al, byte ptr [bx+0x29]
    inc     byte ptr [bx+0x29]
    sub     ah, ah
    mov     si, ax
    and     si, 0x7
    mov     bx, word ptr [bp+var_6]
    mov     al, byte ptr es:[bx+si+0x3b]
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx+0x22], al
LAB_3863_1274:
    mov     bx, word ptr [bp+var_8]
    push    word ptr [bx+0x12]
    push    word ptr [bx+0x10]
    push    word ptr [bx+0x2a]
    push    bx
    mov     al, byte ptr [bx+0x2c]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x27
    mov     word ptr [bp+var_C+2], dx
    mov     word ptr [bp+var_C], ax
    call    dword ptr [bp+var_C]
    add     sp, 0xa
LAB_3863_129d:
    inc     word ptr [bp+var_2]
LAB_3863_12a0:
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    cmp     word ptr [bp+var_2], ax
    jnc     LAB_3863_1316
    mov     ax, 0x2e
    imul    word ptr [bp+var_2]
    add     ax, 0xa2b6
    mov     word ptr [bp+var_8], ax
    mov     bx, ax
    cmp     byte ptr [bx+0x1], 0x0
    jz      LAB_3863_129d
    cmp     byte ptr [bx], 0xf
    jbe     LAB_3863_12cb
    push    ax
    push    cs
    call    near ptr sub_3968A
    add     sp, 0x2
LAB_3863_12cb:
    mov     bx, word ptr [bp+var_8]
    mov     ax, word ptr [bx+0x10]
    mov     dx, word ptr [bx+0x12]
    mov     word ptr [bp+var_6], ax
    mov     word ptr [bp+var_6+2], dx
    cmp     byte ptr [bx+0x16], 0x1
    jz      LAB_3863_12e3
    jmp     near ptr LAB_3863_10ed
LAB_3863_12e3:
    les     si, [bp+var_6]
    mov     ax, word ptr es:[si+0x20]
    add     word ptr [bx+0x14], ax
    mov     ax, word ptr es:[si+0x1e]
    cmp     word ptr [bx+0x14], ax
    jge     LAB_3863_12f9
    jmp     near ptr LAB_3863_10ed
LAB_3863_12f9:
    mov     word ptr [bx+0x14], ax
    mov     bx, si
    mov     ax, word ptr es:[bx+0x1e]
    cmp     word ptr es:[bx+0x24], ax
    jge     LAB_3863_130b
    jmp     near ptr LAB_3863_10e6
LAB_3863_130b:
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx+0x16], 0x3
    jmp     near ptr LAB_3863_10ed
    db 0x90
LAB_3863_1316:
    mov     ax, 0xa2b6
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x30
    mov     word ptr [bp+var_C+2], dx
    mov     word ptr [bp+var_C], ax
    call    dword ptr [bp+var_C]
    add     sp, 0x2
    pop     ds
    pop     si
    mov     sp, bp
    pop     bp
    retf
sub_39700_asm_ endp

; void __cdecl16far audio_driver_func1E(uint param_1, uint param_2)
audio_driver_func1E_asm_ proc far
    var_16     = dword ptr -22
    var_12     = word ptr  -18
    var_10     = dword ptr -16
    var_C      = word ptr  -12
    var_A      = word ptr  -10
    var_8      = word ptr   -8
    var_6      = word ptr   -6
    var_4      = word ptr   -4
    var_2      = word ptr   -2
    param_1    = word ptr    6
    param_2    = word ptr    8

    push    bp
    mov     bp, sp
    sub     sp, 0x16
    push    di
    push    si
    push    ds
; <REPLACE>
    mov     ax, seg dseg
; </REPLACE>
;    mov     ax, 0x3b77
    mov     ds, ax
    cmp     byte ptr [byte_40634], 0x0
    jz      LAB_3863_134e
    jmp     near ptr LAB_3863_13d4
LAB_3863_134e:
    mov     word ptr [bp+var_2], 0x0
    mov     al, byte ptr [byte_459D2]
    sub     ah, ah
    or      ax, ax
    jnz     LAB_3863_135f
    jmp     near ptr LAB_3863_146e
LAB_3863_135f:
    mov     si, 0xa2b6
    mov     word ptr [bp+var_8], 0xa2b7
    mov     word ptr [bp+var_A], 0xa2c6
    mov     word ptr [bp+var_C], 0xa2b8
    mov     di, word ptr [bp+var_2]
LAB_3863_1374:
    mov     al, byte ptr [si]
    sub     ah, ah
    cmp     ax, word ptr [bp+param_2]
    ja      LAB_3863_13b2
    cmp     ax, word ptr [bp+param_1]
    jc      LAB_3863_13b2
    push    di
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x1e
    mov     word ptr [bp+var_10+2], dx
    mov     word ptr [bp+var_10], ax
    call    dword ptr [bp+var_10]
    add     sp, 0x2
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx], 0x0
    mov     bx, word ptr [bp+var_A]
    sub     ax, ax
    mov     word ptr [bx+0x2], ax
    mov     word ptr [bx], ax
    mov     byte ptr [si], 0xff
    mov     bx, word ptr [bp+var_C]
    mov     byte ptr [bx], 0x0
LAB_3863_13b2:
    add     si, 0x2e
    add     word ptr [bp+var_8], 0x2e
    add     word ptr [bp+var_A], 0x2e
    add     word ptr [bp+var_C], 0x2e
    inc     di
    mov     ax, di
    mov     cl, byte ptr [byte_459D2]
    sub     ch, ch
    cmp     ax, cx
    jc      LAB_3863_1374
    mov     word ptr [bp+var_2], di
    jmp     near ptr LAB_3863_146e
LAB_3863_13d4:
    mov     ax, word ptr [bp+param_1]
    mov     word ptr [bp+var_2], ax
    mov     ax, word ptr [bp+param_2]
    cmp     word ptr [bp+var_2], ax
    jle     LAB_3863_13e5
    jmp     near ptr LAB_3863_146e
LAB_3863_13e5:
    mov     ax, 0x4c
    imul    word ptr [bp+param_1]
    add     ax, 0x8243
    mov     word ptr [bp+var_12], ax
LAB_3863_13f1:
    mov     bx, word ptr [bp+var_12]
    cmp     byte ptr [bx], 0x10
    jnc     LAB_3863_145f
    mov     al, byte ptr [bx]
    sub     ah, ah
    push    ax
    mov     ax, word ptr [audiodriverbinary]
    mov     dx, word ptr [audiodriverbinary+2]
    add     ax, 0x1e
    mov     word ptr [bp+var_16+2], dx
    mov     word ptr [bp+var_16], ax
    call    dword ptr [bp+var_16]
    add     sp, 0x2
    mov     word ptr [bp+var_4], 0x10
    mov     si, 0xa2b6
    mov     di, 0xa2b7
    mov     word ptr [bp+var_A], 0xa2c6
    mov     word ptr [bp+var_8], 0xa2b8
    mov     word ptr [bp+var_6], 0x10
    mov     cx, 0x10
LAB_3863_1431:
    mov     al, byte ptr [si]
    sub     ah, ah
    cmp     word ptr [bp+var_2], ax
    jnz     LAB_3863_144f
    mov     byte ptr [di], ah
    mov     bx, word ptr [bp+var_A]
    sub     ax, ax
    mov     word ptr [bx+0x2], ax
    mov     word ptr [bx], ax
    mov     byte ptr [si], 0xff
    mov     bx, word ptr [bp+var_8]
    mov     byte ptr [bx], 0x0
LAB_3863_144f:
    add     si, 0x2e
    add     di, 0x2e
    add     word ptr [bp+var_A], 0x2e
    add     word ptr [bp+var_8], 0x2e
    loop    LAB_3863_1431
LAB_3863_145f:
    add     word ptr [bp+var_12], 0x4c
    inc     word ptr [bp+var_2]
    mov     ax, word ptr [bp+param_2]
    cmp     word ptr [bp+var_2], ax
    jle     LAB_3863_13f1
LAB_3863_146e:
    mov     ax, word ptr [bp+param_1]
    mov     word ptr [bp+var_2], ax
    mov     ax, word ptr [bp+param_2]
    cmp     word ptr [bp+var_2], ax
    jg      LAB_3863_149a
    mov     ax, 0x4c
    imul    word ptr [bp+param_1]
    mov     si, ax
    add     si, 0x8211
    mov     cx, word ptr [bp+param_2]
    sub     cx, word ptr [bp+param_1]
    inc     cx
    add     word ptr [bp+var_2], cx
LAB_3863_1492:
    mov     byte ptr [si], 0x0
    add     si, 0x4c
    loop    LAB_3863_1492
LAB_3863_149a:
    pop     ds
    pop     si
    pop     di
    mov     sp, bp
    pop     bp
    retf
audio_driver_func1E_asm_ endp

seg028 ends
end
